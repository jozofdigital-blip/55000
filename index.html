<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>500 –∑–ª–æ–±–Ω—ã—Ö –∫–∞—Ä—Ç ‚Äî –º—É–ª—å—Ç–∏–ø–ª–µ–µ—Ä</title>
<!--
  –û–¥–Ω–æ—Ñ–∞–π–ª–æ–≤–∞—è –º–æ–±–∏–ª—å–Ω–∞—è –∏–≥—Ä–∞ ¬´500 –∑–ª–æ–±–Ω—ã—Ö –∫–∞—Ä—Ç¬ª –Ω–∞ Firebase Realtime Database.
  –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:
  - Mobile-first, —Ç—ë–º–Ω–∞—è —Ç–µ–º–∞, —Å—Ç–µ–∫–ª—è–Ω–Ω—ã–µ –ø–∞–Ω–µ–ª–∏.
  - –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–Ω–∞—Ç—ã (–≤–µ–¥—É—â–∏–π), –ø—Ä–∏–≥–ª–∞—Å–∏—Ç–µ–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞, –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–æ–≤ –ø–æ —Å—Å—ã–ª–∫–µ.
  - –†–æ–ª–∏: –≤–µ–¥—É—â–∏–π –±–µ–∑ —Ä—É–∫–∏; –∏–≥—Ä–æ–∫–∏ –ø–æ–ª—É—á–∞—é—Ç 7 –±–µ–ª—ã—Ö –∫–∞—Ä—Ç, –≤—ã–±–∏—Ä–∞—é—Ç 1, –æ—Ç–≤–µ—Ç—ã –∞–Ω–æ–Ω–∏–º–Ω—ã –∏ –ø–µ—Ä–µ–º–µ—à–∞–Ω—ã.
  - –†–∞—É–Ω–¥—ã: —á—ë—Ä–Ω–∞—è –∫–∞—Ä—Ç–∞ (1‚Äì2 –ø—Ä–æ–ø—É—Å–∫–∞), —Ç–∞–π–º–µ—Ä 60s, –∞–≤—Ç–æ-–ø–æ–±–µ–¥–∏—Ç–µ–ª—å –ø—Ä–∏ –∏—Å—Ç–µ—á–µ–Ω–∏–∏.
  - –°–º–µ–Ω–∞ –≤–µ–¥—É—â–µ–≥–æ –ø–æ –∫—Ä—É–≥—É.
  - –ö–æ–ª–æ–¥–∞: >=200 —á—ë—Ä–Ω—ã—Ö, >=600 –±–µ–ª—ã—Ö (—á–∞—Å—Ç—å –≤—Ä—É—á–Ω—É—é, –æ—Å—Ç–∞–ª—å–Ω–æ–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è), –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ NSFW.
  - –ú–∏–Ω–∏-¬´–∞–≤—Ç–æ—Ç–µ—Å—Ç—ã¬ª –ª–æ–≥–∏–∫–∏ (shuffle, nextHostId, –¥–æ–±–æ—Ä —Ä—É–∫–∏ –∏ –ø—Ä.) ‚Äî —Å–º–æ—Ç—Ä–∏—Ç–µ –∫–æ–Ω—Å–æ–ª—å.
  –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏:
    1) –í—Å—Ç–∞–≤—å—Ç–µ –≤–∞—à Firebase config –Ω–∏–∂–µ (—É–∂–µ –∑–∞–ø–æ–ª–Ω–µ–Ω –∏–∑ –ø—Ä–∏–º–µ—Ä–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è).
    2) –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª –∫–∞–∫ index.html (GitHub Pages –æ–∫).
-->
<style>
:root{
  --bg:#0d1016;--panel:#171b27;--panel-soft:rgba(23,27,39,.86);
  --muted:#8b93a7;--text:#f1f3fb;--accent:#7c5cff;--accent-2:#25d0a2;
  --danger:#ff5c7c;--chip:#20263a;--border:#2a3248;--card:#1b2030;
  --shadow:0 16px 44px rgba(0,0,0,.45);--focus-ring:0 0 0 3px rgba(124,92,255,.35);
  --safe-bottom:env(safe-area-inset-bottom,0px);
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;font-family:ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,Ubuntu,Cantarell,"Noto Sans","Helvetica Neue",Arial;
  min-height:100vh;
  background:radial-gradient(circle at 20% -10%,rgba(124,92,255,.25),transparent 55%),
             radial-gradient(circle at 80% -10%,rgba(37,208,162,.18),transparent 60%),var(--bg);
  color:var(--text);
}
button{border:none;font:inherit;cursor:pointer;transition:transform .16s,filter .18s,box-shadow .2s}
button:disabled{opacity:.55;cursor:not-allowed;box-shadow:none;transform:none;filter:none}
button:focus-visible{outline:none;box-shadow:var(--focus-ring)}
.primary{background:var(--accent);color:#fff;padding:13px 18px;border-radius:16px;font-weight:700;box-shadow:var(--shadow)}
.ghost-rounded{padding:12px 16px;border-radius:16px;font-weight:600}
.wrap{max-width:900px;margin:0 auto;padding:0 16px 140px}
header{display:flex;align-items:center;justify-content:space-between;padding:18px 20px 12px;position:sticky;top:0;z-index:30;background:linear-gradient(180deg,rgba(13,16,22,.95),rgba(13,16,22,.65) 60%,transparent);backdrop-filter:blur(12px)}
.logo{display:flex;gap:12px;font-weight:800;font-size:20px}
.logo b{background:linear-gradient(135deg,var(--accent),#b28dff);-webkit-background-clip:text;background-clip:text;color:transparent}
main{display:none;margin-top:24px}
main.active{display:block}
.card{background:var(--panel);border:1px solid var(--border);border-radius:22px;padding:22px;box-shadow:var(--shadow);backdrop-filter:blur(10px)}
.muted{color:var(--muted)} .small{font-size:13px;opacity:.85}
label{display:flex;flex-direction:column;gap:8px;font-weight:600}
input[type="text"], textarea{
  width:100%;appearance:none;-webkit-appearance:none;padding:14px 16px;border-radius:16px;border:1px solid var(--border);
  background:rgba(32,38,58,.75);color:var(--text);font-size:17px; line-height:1.4;outline:none;
  transition:border .15s ease, box-shadow .15s ease, background .15s ease;
}
input[type="text"]::placeholder{color:#9aa3bb}
input[type="text"]:hover{background:rgba(32,38,58,.85)}
input[type="text"]:focus{border-color:var(--accent);box-shadow:var(--focus-ring);background:rgba(32,38,58,.95)}
.field-gap{display:flex;flex-direction:column;gap:16px;margin-bottom:18px}
.actions-row{display:flex;flex-direction:column;gap:12px;margin-top:10px}
.status-board{display:flex;flex-wrap:wrap;gap:10px;align-items:center;margin-bottom:18px}
.chip{display:inline-flex;align-items:center;gap:6px;background:var(--chip);border:1px solid var(--border);color:#d2d9ef;padding:8px 12px;border-radius:999px;font-size:13px;font-weight:600}
.black-card{background:#050608;border:1px solid #1f2536;color:#fff;border-radius:22px;padding:22px;margin-bottom:20px;box-shadow:0 18px 48px rgba(0,0,0,.45)}
.cards-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(210px,1fr));gap:14px}
.answer-card{background:var(--card);border:1px solid var(--border);border-radius:20px;padding:18px;text-align:left;line-height:1.5;transition:transform .2s,box-shadow .2s}
.answer-card.selectable{cursor:pointer}
.answer-card.selectable:hover{transform:translateY(-2px);box-shadow:0 18px 40px rgba(0,0,0,.4)}
.answer-card.selected{outline:2px solid var(--accent);box-shadow:0 0 0 3px rgba(124,92,255,.35),0 18px 40px rgba(0,0,0,.45);transform:translateY(-3px)}
.answer-card.disabled{opacity:.55;pointer-events:none}
.toast{position:fixed;left:50%;bottom:calc(20px + var(--safe-bottom));transform:translate(-50%,60px);padding:14px 18px;background:var(--panel-soft);border:1px solid rgba(255,255,255,.08);border-radius:16px;box-shadow:var(--shadow);font-weight:600;opacity:0;pointer-events:none;transition:transform .25s,opacity .22s;z-index:120}
.toast.show{opacity:1;pointer-events:auto;transform:translate(-50%,-4px)}
#actionBar{position:fixed;left:50%;transform:translateX(-50%);bottom:calc(16px + var(--safe-bottom));width:min(560px,calc(100vw - 28px));display:flex;align-items:center;justify-content:space-between;gap:14px;padding:16px 18px;background:rgba(20,23,34,.96);border:1px solid rgba(255,255,255,.08);border-radius:18px;box-shadow:var(--shadow);backdrop-filter:blur(14px);z-index:50;transition:opacity .2s,transform .24s}
#actionBar.hidden{opacity:0;pointer-events:none;transform:translate(-50%,40px)}
@media (max-width:640px){.wrap{padding:0 14px 160px}.card,.black-card{padding:20px}}
</style>
</head>
<body>
<header>
  <div class="logo">üÉè <b>500 –∑–ª. –∫–∞—Ä—Ç</b></div>
</header>

<div class="wrap">
  <!-- –≠–∫—Ä–∞–Ω 1: –í–µ–¥—É—â–∏–π —Å–æ–∑–¥–∞—ë—Ç –∫–æ–º–Ω–∞—Ç—É -->
  <main id="screenCreate" class="active" aria-labelledby="hCreate">
    <section class="card">
      <h1 id="hCreate">–°–æ–∑–¥–∞—Ç—å –∫–æ–º–Ω–∞—Ç—É</h1>
      <p class="muted">–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–¥–µ–ª–∏—Ç–µ—Å—å —Å—Å—ã–ª–∫–æ–π. –ö–æ–≥–¥–∞ –ø–æ–¥–∫–ª—é—á–∞—Ç—Å—è –∏–≥—Ä–æ–∫–∏, –Ω–∞–∂–º–∏—Ç–µ ¬´–ù–∞—á–∞—Ç—å –∏–≥—Ä—É¬ª.</p>
      <div class="field-gap">
        <label>–í–∞—à–µ –∏–º—è
          <input type="text" id="createName" maxlength="24" autocomplete="name" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä, –°–µ—Ä–≥–µ–π" />
        </label>
        <label>ID –∫–æ–º–Ω–∞—Ç—ã
          <input type="text" id="createRoomId" maxlength="8" autocomplete="off" />
        </label>
        <label>
          NSFW —Ä–µ–∂–∏–º
          <input type="checkbox" id="nsfwToggle" />
        </label>
      </div>
      <div class="actions-row">
        <button id="btnCreateRoom" class="primary">–°–æ–∑–¥–∞—Ç—å –∫–æ–º–Ω–∞—Ç—É</button>
        <span id="createError" class="muted" style="color:#ffb1c5;min-height:20px;"></span>
      </div>
    </section>
  </main>

  <!-- –≠–∫—Ä–∞–Ω 2: –ò–≥—Ä–æ–∫ –ø–æ —Å—Å—ã–ª–∫–µ -->
  <main id="screenNameOnly" aria-labelledby="hNameOnly">
    <section class="card">
      <h1 id="hNameOnly">–í–≤–µ–¥–∏—Ç–µ –∏–º—è</h1>
      <p class="muted" id="inviteLine" style="margin-top:-6px">–í–∞—Å –ø—Ä–∏–≥–ª–∞—à–∞–µ—Ç <b id="inviterName">‚Ä¶</b></p>
      <div class="field-gap" style="margin-top:8px">
        <label>–í–∞—à–µ –∏–º—è
          <input type="text" id="nameOnly" maxlength="24" autocomplete="name" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä, –õ—ë—à–∞" />
        </label>
      </div>
      <div class="actions-row">
        <button id="btnNameOnly" class="primary">–í–æ–π—Ç–∏ –≤ –∏–≥—Ä—É</button>
        <span id="nameOnlyError" class="muted" style="color:#ffb1c5;min-height:20px;"></span>
      </div>
    </section>
  </main>

  <!-- –≠–∫—Ä–∞–Ω 3: –ò–≥—Ä–∞ -->
  <main id="screenGame" aria-labelledby="hGame">
    <section class="card" id="shareSection">
      <div id="shareRow" style="display:none;align-items:center;gap:12px;margin-bottom:18px;">
        <input type="text" id="shareLink" readonly aria-label="–°—Å—ã–ª–∫–∞ –Ω–∞ –∫–æ–º–Ω–∞—Ç—É" />
        <button id="btnCopyLink" class="ghost-rounded">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É</button>
      </div>

      <div class="status-board">
        <span class="chip" id="connStatus">–°—Ç–∞—Ç—É—Å: –Ω–µ –ø—Ä–æ–≤–µ—Ä–µ–Ω–æ</span>
        <span class="chip" id="timerChip" hidden>‚è± 60s</span>
        <span class="chip" id="progressChip" hidden>0/0</span>
        <span class="chip" id="roleChip" hidden>‚Äî</span>
      </div>

      <div id="lobbyActions" class="actions-row" style="display:none;margin-top:8px;">
        <button id="btnStartGame" class="primary">–ù–∞—á–∞—Ç—å –∏–≥—Ä—É</button>
        <span id="lobbyHint" class="muted small"></span>
      </div>

      <div class="black-card" aria-live="polite">
        <div class="muted">–ß—ë—Ä–Ω–∞—è –∫–∞—Ä—Ç–∞</div>
        <div id="blackText" style="margin-top:10px;font-size:20px;line-height:1.5;">‚Äî</div>
      </div>
      <div class="muted small" id="hostSummary">–°—Ç–∞—Ç—É—Å: –æ–∂–∏–¥–∞–Ω–∏–µ.</div>

      <div class="section-title" style="display:flex;justify-content:space-between;align-items:center;margin:28px 0 14px;">
        <h2 id="hYourCards">–í–∞—à–∏ –∫–∞—Ä—Ç—ã</h2>
      </div>
      <div class="muted small" id="handHint">–û–∂–∏–¥–∞–µ–º —Ä–∞–∑–¥–∞—á—É.</div>
      <div class="cards-grid" id="handCards" style="margin-top:14px;"></div>

      <div id="submittedCard" class="winner-card" style="margin-top:16px;display:none;">
        <div class="muted small">–í—ã –æ—Ç–ø—Ä–∞–≤–∏–ª–∏</div>
        <div id="submittedText" style="margin-top:8px;font-size:18px;line-height:1.45;">‚Äî</div>
      </div>

      <div class="section-title" style="margin-top:28px;">
        <h2 id="hAnswers">–û—Ç–≤–µ—Ç—ã –Ω–∞ —Å—Ç–æ–ª–µ</h2>
      </div>
      <div id="submissionsHint" class="muted small">–ñ–¥—ë–º –∏–≥—Ä–æ–∫–æ–≤.</div>
      <div id="submissionsList" class="cards-grid" style="margin-top:14px;"></div>

      <div id="resultBlock" class="winner-card" style="margin-top:28px;display:none;">
        <div class="muted small">–ü–æ–±–µ–¥–∏—Ç–µ–ª—å —Ä–∞—É–Ω–¥–∞</div>
        <div id="winnerLine" style="margin-top:10px;font-size:18px;line-height:1.5;">‚Äî</div>
        <div class="actions-row" style="margin-top:16px;">
          <button id="btnNextRound" class="primary">–°–ª–µ–¥—É—é—â–∏–π —Ä–∞—É–Ω–¥</button>
          <span id="resultHint" class="muted small"></span>
        </div>
      </div>
    </section>

    <section class="card" style="margin-top:18px;">
      <div class="section-title" style="margin:0 0 14px;">
        <h2>–ò–≥—Ä–æ–∫–∏</h2>
      </div>
      <div class="scroll" id="playersList" aria-live="polite" style="max-height:320px;overflow:auto;"></div>
    </section>
  </main>
</div>

<div id="actionBar" class="hidden" role="status" aria-live="polite">
  <div id="actionHint">–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ä—Ç—É –∏ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ.</div>
  <button id="btnConfirm" class="primary" disabled>–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å</button>
</div>

<div id="toast" class="toast" role="status" aria-live="polite"></div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
<script>
// ====== –ö–æ–Ω—Ñ–∏–≥ Firebase (–∑–∞–º–µ–Ω–∏ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏)
const FIREBASE_CONFIG = {
  apiKey: "AIzaSyDRtpegXwTsSf77dPIOGDIyBFvib_GgUcM",
  authDomain: "z-e86ee.firebaseapp.com",
  databaseURL: "https://z-e86ee-default-rtdb.europe-west1.firebasedatabase.app",
  projectId: "z-e86ee",
  storageBucket: "z-e86ee.appspot.com",
  messagingSenderId: "268263276853",
  appId: "1:268263276853:web:0195c839f5dd38e7214c7c",
  measurementId: "G-6ZBVR66GZE"
};

// ====== –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã
const STATUS={LOBBY:'lobby',COLLECT:'collect',RESULT:'result'};
const MIN_PLAYERS=2, ROUNDS_TOTAL=10, ROUND_TIMER_SECONDS=60;
const STORAGE_KEY='zlobnye_karty_deck_v3';
const AUTO_START=false; // –æ—Å—Ç–∞–≤–∏–º —Ä—É—á–Ω–æ–π —Å—Ç–∞—Ä—Ç –≤–µ–¥—É—â–∏–º
const MIN_BLACK=200, MIN_WHITE=600; // –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

// ====== –£—Ç–∏–ª–∏—Ç—ã
const $=s=>document.querySelector(s), $$=s=>Array.from(document.querySelectorAll(s));
const uid=()=>Math.random().toString(36).slice(2,10), now=()=>Date.now();
const shuffle=a=>{for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]]}return a};
const escapeHtml=s=>String(s||'').replace(/[&<>"']/g,ch=>({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;' })[ch]);
function toast(msg){const el=$('#toast');el.textContent=msg;el.classList.add('show');clearTimeout(toast._t);toast._t=setTimeout(()=>el.classList.remove('show'),2400)}
const $focus=el=>{try{el?.focus({preventScroll:true})}catch{}};
function normalizeError(err){if(!err)return'–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞';if(typeof err==='string')return err;const c=err.code||'';if(c.includes('network'))return'–ù–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å Firebase.';if(c.includes('permission'))return'–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤ Firebase.';if(c.includes('timeout'))return'–í—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è –∏—Å—Ç–µ–∫–ª–æ.';return err.message||'–ß—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫.'}
function showError(e){console.error(e);toast('–û—à–∏–±–∫–∞: '+normalizeError(e))}

// ====== –î–µ–∫–∏ (—á–∞—Å—Ç–∏—á–Ω–æ –≤—Ä—É—á–Ω—É—é —Å–º–µ—à–Ω–æ + –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–æ –º–∏–Ω–∏–º—É–º–∞)
const BASE_BLACK=[
  '–õ—É—á—à–µ–µ —Å—Ä–µ–¥—Å—Ç–≤–æ –æ—Ç –ø–ª–æ—Ö–æ–≥–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è ‚Äî ____.',
  '–í –æ—Ñ–∏—Å–µ –∑–∞–ø—Ä–µ—Ç–∏–ª–∏ ____ –ø–æ—Å–ª–µ –ø—Ä–æ—à–ª–æ–π –≤–µ—á–µ—Ä–∏–Ω–∫–∏.',
  '–ú–æ–π —Ç–∞–π–Ω—ã–π —Ç–∞–ª–∞–Ω—Ç ‚Äî ____.',
  '–ö–æ–º–±–æ –¥–Ω—è: ____ —Å —Å–æ—É—Å–æ–º –∏–∑ ____.',
  '–ù–∞ –ø–µ—Ä–≤–æ–º —Å–≤–∏–¥–∞–Ω–∏–∏ –Ω–µ —Å–æ–≤–µ—Ç—É—é –æ–±—Å—É–∂–¥–∞—Ç—å ____.',
  '–£—á—ë–Ω—ã–µ –Ω–∞–∫–æ–Ω–µ—Ü-—Ç–æ –ø—Ä–∏–¥—É–º–∞–ª–∏ ____.',
  '–°–∞–º–æ–µ –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω–æ–µ –≤ –ø–æ–¥–∞—Ä–æ–∫ ‚Äî ____.',
  '–ù–æ–≤–æ–µ —Ö–æ–±–±–∏, –æ –∫–æ—Ç–æ—Ä–æ–º —Å—Ç—ã–¥–Ω–æ —Ä–∞—Å—Å–∫–∞–∑–∞—Ç—å —Ä–æ–¥–∏—Ç–µ–ª—è–º: ____.',
  '–ó–∞–≤—Ç—Ä–∞–∫ —á–µ–º–ø–∏–æ–Ω–∞ ‚Äî ____.',
  '–ü—É—Ç—å –∫ —É—Å–ø–µ—Ö—É –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å ____.',
  '–°–º–æ—Ç—Ä–∏, –Ω–µ –ø–µ—Ä–µ–ø—É—Ç–∞–π: ____ –∏ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π —á–∞—Ç.',
  '–í —ç–ª–∏—Ç–Ω–æ–º –∫–ª—É–±–µ —Ç—Ä–µ–±—É—é—Ç –¥—Ä–µ—Å—Å-–∫–æ–¥ –∏ ____.',
  '–Ø –ø–µ—Ä–µ—Å—Ç–∞–Ω—É –ø—Ä–æ–∫—Ä–∞—Å—Ç–∏–Ω–∏—Ä–æ–≤–∞—Ç—å –∑–∞–≤—Ç—Ä–∞. –°–µ–≥–æ–¥–Ω—è —É –º–µ–Ω—è ____.',
  '–õ—É—á—à–µ–µ, —á—Ç–æ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤ —Ä–µ–∑—é–º–µ ‚Äî ____.',
  '–í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –∫—Ä–∏—Ç–∏–∫ –æ–±–æ–∂–∞–µ—Ç ____.',
  '–®–µ—Ñ –º–µ—á—Ç–∞–µ—Ç –≤–Ω–µ–¥—Ä–∏—Ç—å ____.',
  '–ò–¥–µ–∞–ª—å–Ω–æ–µ –∞–ª–∏–±–∏: ____.',
  '–¢–æ, —á–µ–≥–æ –Ω–µ —Ö–≤–∞—Ç–∞–ª–æ –Ω–æ–≤–æ–º—É –∞–π—Ñ–æ–Ω—É ‚Äî ____.',
  '–ú–æ–π –ø–ª–∞–Ω –Ω–∞ –≥–æ–¥: —Å–ø–æ—Ä—Ç, –º–µ–¥–∏—Ç–∞—Ü–∏—è –∏ ____.',
  '–°–µ–∫—Ä–µ—Ç —Ö–æ—Ä–æ—à–µ–π –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–∏ ‚Äî ____.',
  '–í –Ω–æ–≤–æ–π –≤–µ—Ä—Å–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –º—ã –¥–æ–±–∞–≤–∏–ª–∏ ____ –∏ —É–±—Ä–∞–ª–∏ —Å–æ–≤–µ—Å—Ç—å.',
  '–ü–æ—Å–ª–µ —Ç—Ä—ë—Ö —á–∞—à–µ–∫ –∫–æ—Ñ–µ –º–µ–Ω—è —Å–ª–æ–∂–Ω–æ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å, –æ—Å–æ–±–µ–Ω–Ω–æ —Å ____.',
  '–ù–µ–ª–æ–≤–∫–∞—è –ø–∞—É–∑–∞ ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ –≤—Å–µ –º–æ–ª—á–∞—Ç, –∞ —Ç—ã –¥–æ—Å—Ç–∞—ë—à—å ____.',
  '–ß–µ–≥–æ —Ç–æ—á–Ω–æ –Ω–µ —Å—Ç–æ–∏—Ç –ø–∏—Å–∞—Ç—å –≤ —á–∞—Ç –≤ 3:00 ‚Äî –ø—Ä–æ ____.',
  '–Ø –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ –æ—Ç–∫–∞–∑—ã–≤–∞—é—Å—å –æ—Ç ____.',
  '–°–µ–≥–æ–¥–Ω—è –æ—Ç–º–µ–Ω—è–µ—Ç—Å—è –≤—Å—ë, –∫—Ä–æ–º–µ ____.',
  '–•—É–¥—à–µ–µ, —á—Ç–æ –º–æ–∂–Ω–æ —É—Å–ª—ã—à–∞—Ç—å –æ—Ç –Ω–∞–≤–∏–≥–∞—Ç–æ—Ä–∞ ‚Äî ¬´–ü–æ–≤–µ—Ä–Ω–∏—Ç–µ –∫ ____¬ª.',
  '–í –∫–æ—Ä–æ–±–∫–µ —Å —Å—é—Ä–ø—Ä–∏–∑–æ–º: ____ –∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –Ω–∞ –∫–∏—Ç–∞–π—Å–∫–æ–º.',
  '–ù–∞ TED —è –≤—ã—Å—Ç—É–ø–ª—é –ø—Ä–æ ____.',
  '–°–µ–∫—Ä–µ—Ç —Å–µ–º–µ–π–Ω–æ–≥–æ —Å—á–∞—Å—Ç—å—è ‚Äî ____.',
  '–ù–æ–≤–∞—è –Ω–∞—Ü. –∏–¥–µ—è: ____ –∏ –æ–ø—Ç–∏–º–∏–∑–º –Ω–∞ –ø–æ–¥–ø–∏—Å–∫–µ.',
  '–ú–æ—è –≤–∑—Ä–æ—Å–ª–∞—è –∂–∏–∑–Ω—å ‚Äî —ç—Ç–æ –Ω–∞–ª–æ–≥–∏ –∏ ____.',
  '–ü—è—Ç–Ω–∏—á–Ω—ã–π —Ä–∏—Ç—É–∞–ª: ____ –∏ –Ω–µ –±—Ä–∞—Ç—å —Ç—Ä—É–±–∫—É.',
  '–°–æ—Å–µ–¥ —Å–≤–µ—Ä—Ö—É –ø—Ä–∞–∫—Ç–∏–∫—É–µ—Ç ____. –ú—ã ‚Äî —Ç–µ—Ä–ø–µ–Ω–∏–µ.',
  '–Ø –±—ã —Å —Ä–∞–¥–æ—Å—Ç—å—é –∑–∞–º–µ–Ω–∏–ª(–∞) –≥–∏–º–Ω –Ω–∞ ____.',
  '–î–æ—Ä–æ–≥–æ-–±–æ–≥–∞—Ç–æ: ____ –∏ –ø–æ–∑–æ–ª–æ—Ç–∞.',
  '–ï—Å–ª–∏ –±—ã —É –º–µ–Ω—è –±—ã–ª —Å–ª–æ–≥–∞–Ω, –æ–Ω –±—ã –±—ã–ª –ø—Ä–æ ____.',
  '–¢—É—Ä–±–æ-—Ä–µ–∂–∏–º –≤–∫–ª—é—á–∞–µ—Ç—Å—è –æ—Ç ____.',
  '–í –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–º —á–∞—Ç–µ –∑–∞–±–∞–Ω–∏–ª–∏ —Ç–µ–º—É ____.',
  '–ö–æ–≥–¥–∞ –Ω–∏–∫—Ç–æ –Ω–µ –≤–∏–¥–∏—Ç, —è –ø—Ä–∞–∫—Ç–∏–∫—É—é ____.',
  '–£—Ç—Ä–µ–Ω–Ω–∏–π –∫–æ—Ñ–µ —Å –ø—Ä–∏–≤–∫—É—Å–æ–º ____.',
  '–ì–ª–∞–≤–Ω—ã–π –∞–Ω—Ç–∏—Å—Ç—Ä–µ—Å—Å ‚Äî ____.',
  '–í –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –æ—à–∏–±–∫–∞: –≤–º–µ—Å—Ç–æ —Ä–∞—Å—á—ë—Ç–∞ –Ω–∞–ª–æ–≥–æ–≤ ‚Äî ____.',
  '–ú–æ–π –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π —Ä–µ–±—ë–Ω–æ–∫ —Ö–æ—Ç–µ–ª –º–æ—Ä–æ–∂–µ–Ω–æ–µ, –∞ –ø–æ–ª—É—á–∏–ª ____.',
  '–ù–∞ —Å–æ–≤–µ—â–∞–Ω–∏–∏ –ª—É—á—à–µ –Ω–µ –æ–±—Å—É–∂–¥–∞—Ç—å ____.',
  '–°–ø–æ—Ä–∏–º, –≤ 2035 –º—ã –±—É–¥–µ–º –ø–ª–∞—Ç–∏—Ç—å –∑–∞ ____.',
  '–°–∞–º—ã–π —Å—Ç—Ä–∞–Ω–Ω—ã–π –ø–æ–¥–∞—Ä–æ–∫ ‚Äî ____.',
  '–°–µ–≥–æ–¥–Ω—è—à–Ω–∏–π –ø–ª–∞–Ω: –∫–æ—Ñ–µ, –¥–µ–ª–∞ –∏ ____.',
  '–õ—ë–≥–∫–∏–π —Å–ø–æ—Å–æ–± –∑–∞–≤–µ—Å—Ç–∏ –¥—Ä—É–∑–µ–π ‚Äî ____.',
  '–ù–∏–∫—Ç–æ –Ω–µ –∏–¥–µ–∞–ª–µ–Ω, –∫—Ä–æ–º–µ ____.',
  '–ë—ã—Å—Ç—Ä–æ–µ —Å–≤–∏–¥–∞–Ω–∏–µ: 5 –º–∏–Ω—É—Ç –∏ ____.',
  '–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–µ—á—Ç–æ–π —á–µ—Ä–µ–∑ ____.',
  '–ö–æ—É—á –ø–æ—Å–æ–≤–µ—Ç–æ–≤–∞–ª –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å ____.',
  '–í –¥–æ–º–∞—à–Ω–µ–π –∞–ø—Ç–µ—á–∫–µ: –±–∏–Ω—Ç, –∑–µ–ª—ë–Ω–∫–∞ –∏ ____.',
  '–ö—Ç–æ-—Ç–æ —Å–∫–∞–∑–∞–ª ¬´—Ç–∏–º–±–∏–ª–¥–∏–Ω–≥¬ª? –î–æ—Å—Ç–∞–≤–∞–π—Ç–µ ____.',
  '–ú–æ–π pet project ‚Äî —ç—Ç–æ ____.',
  '–õ–µ–≥–µ–Ω–¥–∞ –≥–ª–∞—Å–∏—Ç: –æ–¥–Ω–∞–∂–¥—ã –∫—Ç–æ-—Ç–æ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Å–¥–µ–ª–∞–ª ____.',
  '–ù–æ–≤—ã–π –∫—É—Ä—Å: ¬´–ö–∞–∫ –ø–µ—Ä–µ—Å—Ç–∞—Ç—å –∏ –Ω–∞—á–∞—Ç—å ____¬ª.',
  '–ü–æ–¥–∫–∞—Å—Ç, –∫–æ—Ç–æ—Ä—ã–π —Å–ª—É—à–∞—é—Ç —Ç—Ä–æ–µ, –Ω–æ —Ç–∞–º –µ—Å—Ç—å ____.',
  '–î–æ–º-—Ä–∞–±–æ—Ç–∞-–¥–æ–º –∏ –º–µ–∂–¥—É –Ω–∏–º–∏ _____.',
  '–ê–ª–≥–æ—Ä–∏—Ç–º —Å—á–∞—Å—Ç—å—è: –µ–¥–∞, —Å–æ–Ω –∏ ____.',
  '–î–ª—è –ø–æ–ª–Ω–æ–π –∫–∞—Ä—Ç–∏–Ω—ã –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç ____.',
  '–ì–∏–¥ –ø–æ –≤—ã–∂–∏–≤–∞–Ω–∏—é –≤ –æ—Ñ–∏—Å–µ: –∫–æ—Ñ–µ, –Ω–∞—É—à–Ω–∏–∫–∏ –∏ ____.',
  '–ú–µ–¥–∏—Ç–∞—Ü–∏—è –Ω–∞ —Ç–µ–º—É ____.',
  '–°–µ–∫—Ä–µ—Ç–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ ‚Äì ____ –ø—Ä–∏ –≤–∫–ª—é—á—ë–Ω–Ω–æ–π –≤–µ–±-–∫–∞–º–µ—Ä–µ.',
  '–°–æ—Å–µ–¥ –ø–æ —ç–ª–µ–∫—Ç—Ä–∏—á–∫–µ –ø—Ä–æ–¥–∞—ë—Ç ____ –∏ –Ω–µ —Å–¥–∞—ë—Ç.',
  '–ë–æ–Ω—É—Å –∫ –∑–∞—Ä–ø–ª–∞—Ç–µ: –Ω–∞–∫–ª–µ–π–∫–∏ –∏ ____.',
  '–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å –ø–æ —á–∞—Å—Ç–∏ ____.',
  '–ù–∞ –ø–µ—Ä–≤–æ–º —É—Ä–æ–∫–µ –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å –æ–±—ä—è–≤–∏–ª: —Å–µ–≥–æ–¥–Ω—è –º—ã –ø—Ä–æ ____.',
  '–Ø —Ç—É—Ç —Å–æ—Å—Ç–∞–≤–∏–ª Notion-—Å—Ç—Ä–∞–Ω–∏—Ü—É ¬´____¬ª.',
  '–í –º–æ—ë–º —Ö–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫–µ –∂–∏–≤—É—Ç —Ç–∏—à–∏–Ω–∞, –Ω–∞–¥–µ–∂–¥–∞ –∏ ____.',
  '–ü—É—Ç—å –≥–µ—Ä–æ—è –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å ____.',
  '–ó–û–ñ –Ω–∞ –º–∏–Ω–∏–º–∞–ª–∫–∞—Ö: 10‚ÄØ000 —à–∞–≥–æ–≤ –∏ ____.',
  '–•–æ–±–±–∏, –∫–æ—Ç–æ—Ä–æ–µ —è —Å–∫—Ä—ã–≤–∞—é –æ—Ç –∫–æ–ª–ª–µ–≥ ‚Äî ____.',
  '–ö—É—Ä—Å –º–æ–ª–æ–¥–æ–≥–æ –±–æ–π—Ü–∞: ____.',
  '–í –º–æ—ë–º —á–µ–∫-–ª–∏—Å—Ç–µ —Å–µ–≥–æ–¥–Ω—è —Ç–æ–ª—å–∫–æ ____.',
  '–¢–∞–º, –≥–¥–µ –º–æ—Ç–∏–≤–∞—Ü–∏—è, —Ç–∞–º –∏ ____.',
  'Go-to —Ä–µ—à–µ–Ω–∏–µ –ª—é–±–æ–π –ø—Ä–æ–±–ª–µ–º—ã ‚Äî ____.',
  '–ï—Å–ª–∏ –¥–æ–ª–≥–æ —Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä, –ø–æ—è–≤–∏—Ç—Å—è ____.',
  '–ù–∞ –æ–±–ª–æ–∂–∫–µ Forbes ‚Äî —è –∏ ____.',
  '–ü—Ä–æ–¥–∞–≤–µ—Ü —É–≤–µ—Ä—è–ª, —á—Ç–æ —ç—Ç–æ –æ—Ä–∏–≥–∏–Ω–∞–ª, –∞ —ç—Ç–æ ____.',
  '–ú—É–¥—Ä–æ—Å—Ç—å –¥–Ω—è: –Ω–µ—Ç –ø–æ–≤–æ–¥–∞ ‚Äî –µ—Å—Ç—å ____.',
  '–ö –Ω–æ–≤–æ–º—É –≥–æ–¥—É —è –∫—É–ø–ª—é —Å–µ–±–µ ____.',
  '–†–∞–∑–±—É–¥–∏ –º–µ–Ω—è –≤ 6:00 —Ä–∞–¥–∏ ____.',
  '–Ø –ø–æ–¥–ø–∏—Å–∞–ª—Å—è –Ω–∞ —Ä–∞—Å—Å—ã–ª–∫—É –ø—Ä–æ ____.',
  '–ú–æ–π —Å—Ç–∞—Ä—Ç–∞–ø: ¬´Air____¬ª.',
  '–°–æ—Å–µ–¥ –ø–æ –æ–ø–µ–Ω—Å–ø–µ–π—Å—É –≤–¥–æ—Ö–Ω–æ–≤–ª—è–µ—Ç –º–µ–Ω—è –Ω–∞ ____.',
  '–ê–Ω—Ç–∏-–∫—Ä–∏–∑–∏—Å–Ω—ã–π –Ω–∞–±–æ—Ä: –≥—Ä–µ—á–∫–∞, —Ç—É–∞–ª–µ—Ç–Ω–∞—è –±—É–º–∞–≥–∞ –∏ ____.',
  '–ù–µ–ª–æ–≤–∫–∏–π –∫–æ–º–ø–ª–∏–º–µ–Ω—Ç: ¬´–¢—ã —Å–µ–≥–æ–¥–Ω—è –∫–∞–∫ ____¬ª.',
  '–õ—É—á—à–∞—è –∏–¥–µ—è –ø—Ä–∏—à–ª–∞ –≤ –¥—É—à –∏ –ø—Ä–∏–Ω–µ—Å–ª–∞ ____.',
  '–î–æ—Ä–æ–≥–æ, –±–æ–≥–∞—Ç–æ –∏ —Å ____.',
  '–ü—Ä–∞–Ω–∫ –Ω–µ —É–¥–∞–ª—Å—è, –ø–æ—Ç–æ–º—É —á—Ç–æ ____.',
  '–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –¥–æ–ª–≥? –≠—Ç–æ –∫–æ–≥–¥–∞ –≤–º–µ—Å—Ç–æ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∞ ‚Äî ____.',
  '–°–µ–º–µ–π–Ω–∞—è —Ä–µ–ª–∏–∫–≤–∏—è ‚Äî ____.',
  '–û—Ñ–∏—Ü–∏–∞–Ω—Ç, –º–Ω–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –∫–æ—Ñ–µ –∏ ____.',
  '–ö–æ—Å–º–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –Ω–∞ ____.',
  '–í –∑–∞–ª–µ –æ–∂–∏–¥–∞–Ω–∏—è —Ä–∞–∑–¥–∞—é—Ç ____.',
  '–°–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–µ –∑–∞–∫–æ–Ω—á–∏–ª–æ—Å—å, –∫–æ–≥–¥–∞ —è —Ä–∞—Å—Å–∫–∞–∑–∞–ª –ø—Ä–æ ____.',
  '–î–µ—Ç—Å–∫–∞—è –º–µ—á—Ç–∞ ‚Äî —Å—Ç–∞—Ç—å —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–º –ø–æ ____.',
  '–°—á–∞—Å—Ç–ª–∏–≤—ã –≤–º–µ—Å—Ç–µ: —è, –º–æ–π –ø–ª–µ–¥ –∏ ____.',
  '–í —ç—Ç–æ—Ç —á–∞—Ç –º–æ–∂–Ω–æ —Ç–æ–ª—å–∫–æ —Å ____.',
  '–õ–∞–π—Ñ—Ö–∞–∫: —á—Ç–æ–±—ã –≤—Å—Ç–∞—Ç—å —Ä–∞–Ω–æ, –Ω—É–∂–Ω–æ –ª–µ—á—å —Å ____.',
  '–°—É–¥—å–±–∞ ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ —Ç–µ–±—è –Ω–∞–≥–æ–Ω—è–µ—Ç ____.',
  '–ö—É–ª—å—Ç—É—Ä–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞: –º—É–∑–µ–π, —Ç–µ–∞—Ç—Ä –∏ ____.',
  '–ú–æ–π –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –ë–∏–ª–ª –ì–µ–π—Ç—Å —Å–æ–≤–µ—Ç—É–µ—Ç –∏–Ω–≤–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ ____.',
  '–ß—Ç–æ–±—ã —Å—Ç–∞—Ç—å –ª—É—á—à–µ, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —É–±—Ä–∞—Ç—å –∏–∑ –∂–∏–∑–Ω–∏ ____ –∏ –¥–æ–±–∞–≤–∏—Ç—å ____.',
  '–®–∞—Ö –∏ –º–∞—Ç: —è –ø–æ—Å—Ç–∞–≤–∏–ª –Ω–∞ —Å—Ç–æ–ª ____.',
  '–ù–∞—Å—Ç–æ—è—â–∞—è —Å–≤–æ–±–æ–¥–∞ ‚Äî —ç—Ç–æ ____.',
  '–ö–æ–≥–¥–∞ –≤—Å—ë –∏–¥—ë—Ç –ø–æ –ø–ª–∞–Ω—É, –ø–æ—è–≤–ª—è–µ—Ç—Å—è –Ω–æ–≤—ã–π –ø–ª–∞–Ω: ____.',
  '–í –±–ª–æ–∫–Ω–æ—Ç–µ –Ω–∞ –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ –Ω–∞–ø–∏—Å–∞–Ω–æ ¬´____¬ª.',
  '–ù–æ–≤—ã–π —Ç—Ä–µ–Ω–¥ —Ç–∏–∫—Ç–æ–∫–∞: —á–µ–ª–ª–µ–Ω–¥–∂ —Å ____.',
  '–ì–¥–µ-—Ç–æ –≤–Ω—É—Ç—Ä–∏ –º–µ–Ω—è –∂–∏–≤—ë—Ç –º–∞–ª–µ–Ω—å–∫–∏–π ____.',
  '–Ø –∑–∞—Å–ª—É–∂–∏–ª(–∞) —Å–µ–≥–æ–¥–Ω—è ____.',
  '–°–ª–æ–∂–Ω—ã–µ –ø–µ—Ä–µ–≥–æ–≤–æ—Ä—ã –ø—Ä–æ—à–ª–∏ –ª–µ–≥–∫–æ –±–ª–∞–≥–æ–¥–∞—Ä—è ____.',
  '–ì–æ—Ä–∂—É—Å—å —Ç–µ–º, —á—Ç–æ –º–æ–≥—É –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ ____ –∏ ____.'
];

// —á–∞—Å—Ç—å —á—ë—Ä–Ω—ã—Ö —Å –¥–≤—É–º—è –ø—Ä–æ–ø—É—Å–∫–∞–º–∏
const EXTRA_BLACK_DOUBLE=[
  '–ö–æ–º–±–æ –¥–Ω—è: ____ —Å –≥–∞—Ä–Ω–∏—Ä–æ–º –∏–∑ ____.',
  '–ò–¥–µ–∞–ª—å–Ω—ã–π –≤—ã—Ö–æ–¥–Ω–æ–π: ____ –∏ —á—É—Ç—å-—á—É—Ç—å ____.',
  '–°–µ–∫—Ä–µ—Ç–Ω—ã–π –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç ‚Äî ____ –∏ –∫–∞–ø–µ–ª—å–∫–∞ ____.',
  '–ö—Ä–∞—Ç–∫–∏–π –∫—É—Ä—Å –∂–∏–∑–Ω–∏: ____ ‚Üí ____ ‚Üí —Å–Ω–æ–≤–∞ –∫–æ—Ñ–µ.',
  '–†–µ—Ü–µ–ø—Ç —É—Å–ø–µ—Ö–∞: 20% —Ç–∞–ª–∞–Ω—Ç, 30% —Ç—Ä—É–¥ –∏ 50% ____.',
  '–ü–∞–∫–µ—Ç ¬´–í—Å—ë –≤–∫–ª—é—á–µ–Ω–æ¬ª: ____ –∏ –±–µ–∑–ª–∏–º–∏—Ç –Ω–∞ ____.',
  '–ú–æ–π –±—Ä–µ–Ω–¥: –ª–æ–≥–æ—Ç–∏–ø ‚Äî ____, —Å–ª–æ–≥–∞–Ω ‚Äî ____.',
  '–£—Ç—Ä–æ –±–æ–¥—Ä–æ–µ, –∫–æ–≥–¥–∞ ____ –∏ ____.',
  '–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏ –≤ –±—É–¥—É—â–µ–µ: —Å–Ω–∞—á–∞–ª–∞ ____, –ø–æ—Ç–æ–º ____.',
  '–í –∫–∞—Ä–º–∞–Ω–µ: —Ç–µ–ª–µ—Ñ–æ–Ω, –∫–ª—é—á–∏ –∏ ____ –Ω–∞ —Å–ª—É—á–∞–π ____.',
];

const BASE_WHITE=[
  // ~220 –≤—Ä—É—á–Ω—É—é –∑–∞–±–∞–≤–Ω—ã—Ö –∞—Å—Å–æ—Ü–∏–∞—Ü–∏–π, –æ—Å—Ç–∞–ª—å–Ω–æ–µ –¥–æ–±—å—ë–º –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–æ–º
  '–π–æ–≥–∞ –ø—Ä–∏ —Å–≤–µ—Ç–µ —Ö–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫–∞', '–±–µ–∑–ª–∏–º–∏—Ç–Ω—ã–µ –º–µ–º—ã', '–∫–æ—Ç, –∫–æ—Ç–æ—Ä—ã–π —Å—É–¥–∏—Ç —Ç–µ–±—è', '–ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è –Ω–∞ 200 —Å–ª–∞–π–¥–æ–≤',
  '–∑–≤—É–∫–∏ –ª–µ—Å–∞ –≤ 3 —á–∞—Å–∞ –Ω–æ—á–∏', '–º–∏–∫—Ä–æ–¥–æ–∑—ã —ç–Ω—Ç—É–∑–∏–∞–∑–º–∞', '–µ–∂–µ–¥–Ω–µ–≤–Ω–∏–∫ –Ω–∞ 2035 –≥–æ–¥', '–∫–æ—Ñ–µ —É—Ä–æ–≤–Ω—è ¬´–±–æ—Å—Å¬ª',
  '—Ç–∞–Ω–µ—Ü —Å –ø—ã–ª–µ—Å–æ—Å–æ–º', '—Å—Ä–æ—á–Ω—ã–π —Å–æ–∑–≤–æ–Ω –Ω–∏ –æ —á—ë–º', '–ø–µ—Ä–µ–ø–∏—Å–∫–∞ —Å —Å–∞–º–∏–º —Å–æ–±–æ–π', '–∑–∞—Ä—è–¥–∫–∞ –¥–ª—è –ª–∏—Ü–∞ –∏ —Å–æ–≤–µ—Å—Ç–∏',
  '–ø–æ–¥–∫–∞—Å—Ç, –∫–æ—Ç–æ—Ä—ã–π –Ω–∏–∫—Ç–æ –Ω–µ —Å–ª—É—à–∞–µ—Ç', '–∫–æ–ª–ª–µ–∫—Ü–∏—è –Ω–µ—Å–±—ã–≤—à–∏—Ö—Å—è —Ü–µ–ª–µ–π', '–ø–ª–µ–¥ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏', '—É–¥–∞–ª—ë–Ω–Ω–∞—è –ø—è—Ç–Ω–∏—Ü–∞',
  '–∑–∞–≥–∞–¥–æ—á–Ω—ã–π –¥–µ–¥–ª–∞–π–Ω', '–Ω–æ—á–Ω–æ–π –ø–æ—Ö–æ–¥ –≤ —Ö–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫', '—Ç–∏–∫-—Ç–æ–∫ –¥–ª—è –≤–∑—Ä–æ—Å–ª—ã—Ö ‚Äî —á—Ç–µ–Ω–∏–µ', '—Å–ª—É—á–∞–π–Ω—ã–π –∞–∫—Ç –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏',
  '—à—É–º –∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä–∞ –∫–∞–∫ —Å–∞—É–Ω–¥—Ç—Ä–µ–∫', '—Å–ø–∏—Å–æ–∫ –¥–µ–ª –∏–∑ –æ–¥–Ω–æ–≥–æ –ø—É–Ω–∫—Ç–∞', '–∏–Ω—Ç–µ—Ä–Ω–µ—Ç, –∫–æ—Ç–æ—Ä—ã–π —Ä–∞–±–æ—Ç–∞–µ—Ç ¬´–∏–Ω–æ–≥–¥–∞¬ª', '—É–ª—ã–±–∫–∞ –º–µ–Ω–µ–¥–∂–µ—Ä–∞ –Ω–∞ –≤—Ö–æ–¥–µ',
  '–∫–∞–ª–µ–Ω–¥–∞—Ä—å, –ø–æ–ª–Ω—ã–π –Ω–∞–¥–µ–∂–¥', '–ø–∏–∂–∞–º–∞ –∫–∞–∫ –¥—Ä–µ—Å—Å-–∫–æ–¥', '—á–∞–π –∏–∑ –∫—Ä—É–∂–∫–∏ ¬´—è –º–æ–ª–æ–¥–µ—Ü¬ª', '–Ω–æ—Å–∫–∏ —Å —Å—É–ø–µ—Ä—Å–∏–ª–∞–º–∏',
  '—Ö—Ä—É—Å—Ç—è—â–∞—è –∫–æ—Ä–æ—á–∫–∞ –Ω–∞ –∂–∏–∑–Ω–∏', '–∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –æ—Ç –∞–Ω–æ–Ω–∏–º–∞', '–ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–Ω—ã–π —Ç—Ä–µ–∫–µ—Ä –ø—Ä–∏–≤—ã—á–µ–∫', '–∫–Ω–æ–ø–∫–∞ ¬´–æ—Ç–ª–æ–∂–∏—Ç—å –Ω–∞ –∑–∞–≤—Ç—Ä–∞¬ª',
  '–∑–≤–æ–Ω–æ–∫ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ–≥–æ –≥–µ—Ä–æ—è', '—Å–ª—É—á–∞–π–Ω—ã–π –∞–ø–≥—Ä–µ–π–¥ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è', '–∫–∞—Ä—Ç–∞ –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏ –∫ –∫–æ—Ç—É', '–ø–∏–≤–æ –±–µ–∑ –ø–æ–≤–æ–¥–∞',
  '–≥—Ä–∞–±–ª–∏, –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ –≤—Ä–µ–º–µ–Ω–µ–º', '–∫–æ–º–æ–∫ –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏—è', '—Å—Ç—ã–¥–Ω—ã–π –ø–ª–µ–π–ª–∏—Å—Ç 2010', '—Ç–æ—Ä–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –ø–µ—Ä–µ–∫—É—Å',
  '–º–∏–∫—Ä–æ—Å–∫–æ–ø–∏—á–µ—Å–∫–∞—è –ø–æ–±–µ–¥–∞', '—Å—É–ø–µ—Ä—Å–∫—Ä–µ–ø–∫–∞', '–∑–∞–≥–∞–¥–æ—á–Ω–∞—è –∫–Ω–æ–ø–∫–∞ ¬´–Ω–µ –Ω–∞–∂–∏–º–∞—Ç—å¬ª', '—Ö–ª–æ–ø–æ–∫ –æ–¥–Ω–æ–π –ª–∞–¥–æ–Ω—å—é',
  '–æ–ª–∏–≤—å–µ –¥–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ —Ä–µ–±—ë–Ω–∫–∞', '—Å–Ω–µ–≥, –∫–æ—Ç–æ—Ä—ã–π –≤—Å–µ–≥–¥–∞ –Ω–µ –≤–æ–≤—Ä–µ–º—è', '–µ—â—ë –æ–¥–∏–Ω –±—É–¥–∏–ª—å–Ω–∏–∫', '–º–∏–º–æ–ª—ë—Ç–Ω–∞—è —Å–ª–∞–≤–∞',
  '–≥–∏—Ñ–∫–∞ –≤–º–µ—Å—Ç–æ –∏–∑–≤–∏–Ω–µ–Ω–∏–π', '—Ç–∞–±–ª–∏—á–∫–∞ ¬´—è —Å—Ç–∞—Ä–∞–ª—Å—è¬ª', '—Ç—É–º–∞–Ω–Ω—ã–π –ø–ª–∞–Ω –ë', '–≥–µ—Ä–æ–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–∫—É—Ä',
  '—Ç–∞–π–Ω–∞—è –∫–æ–ª–ª–µ–∫—Ü–∏—è –∫—Ä—É–∂–µ–∫', '–ø–æ—Å–ª–µ–¥–Ω—è—è –ª–æ–∂–∫–∞ –ù—É—Ç–µ–ª–ª—ã', '–∞–∫–∫—É—Ä–∞—Ç–Ω—ã–π —Ö–∞–æ—Å', '–∫–∏—Å–ª–æ—Ä–æ–¥ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏',
  '—Å—É–ø–µ—Ä—Å–∏–ª–∞ ¬´–ø–µ—Ä–µ—Ç–µ—Ä–ø–µ—Ç—å¬ª', '–º–∏–∫—Ä–æ–Ω–∞–≥—Ä–∞–¥–∞ –∑–∞ —É—Å–∏–ª–∏—è', '—á–µ—Ö–æ–ª –¥–ª—è —Å–æ–≤–µ—Å—Ç–∏', '—Ä–µ–∂–∏–º ¬´—è –≤ –¥–æ–º–∏–∫–µ¬ª',
  '–∫–æ—Ç–æ—Ç–µ—Ä–∞–ø–∏—è', '–ø—è—Ç–∏–º–∏–Ω—É—Ç–∫–∞ —Å–ª–∞–≤—ã', '–∑–∞—Ä—è–¥–∫–∞ –æ—Ç –æ–±–Ω–∏–º–∞—à–µ–∫', '–ø–∞–ø–∫–∞ ¬´–≤–∞–∂–Ω–æ–µ –ø–æ—Ç–æ–º¬ª',
  '–ø–æ–ª–µ–∑–Ω—ã–π –∫—Ä–∏–Ω–∂', '–∫–∞—à–∞ –∏–∑ –∞–º–±–∏—Ü–∏–π', '–∂–∏–∑–Ω–µ–Ω–Ω—ã–π –ª–∞–π—Ñ—Ö–∞–∫ –∏–∑ —Ç–∏–∫—Ç–æ–∫–∞', '—Å–ª–æ–≤–æ ¬´—Å–µ–≥–æ–¥–Ω—è¬ª –≤ –∫–∞–≤—ã—á–∫–∞—Ö',
  '–ø—É—Å—Ç–∞—è –±—É—Ç—ã–ª–∫–∞ –º–æ—Ç–∏–≤–∞—Ü–∏–∏', '—Å–≥–æ—Ä–µ–≤—à–∏–π —Ç–æ—Å—Ç –æ–ø—Ç–∏–º–∏–∑–º–∞', '—á–µ–∫–±–æ–∫—Å ¬´—è –º–æ–ª–æ–¥–µ—Ü¬ª', '—Å–∞–º–æ–∫–ª–µ–π–∫–∞ —Å –Ω–∞–¥–µ–∂–¥–æ–π',
  '–±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —Å–ø–∏—Å–æ–∫ —Å–µ—Ä–∏–∞–ª–æ–≤', '—Å–≤–∏–¥–∞–Ω–∏–µ —Å —Ö–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫–æ–º', '—Å—É–≤–µ–Ω–∏—Ä –∏–∑ –¥–µ–¥–ª–∞–π–Ω–∞', '–Ω–∞—à–∞—Ç—ã—Ä—å –¥–ª—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏',
  '–Ω–∞–±–æ—Ä ¬´–≤—ã–≥–æ—Ä–∞–Ω–∏–µ –º–∏–Ω–∏¬ª', '–∫–∞–ª–µ–Ω–¥–∞—Ä—å –ª—É–Ω–Ω–æ–≥–æ –∫–æ—Ñ–µ', '–∑–≤–µ–∑–¥–∞ —É—é—Ç–Ω–æ–≥–æ –ø–ª–µ–¥–∞', '—Å–∏–ª–∞ –Ω–µ–ª–æ–≤–∫–æ–π –ø–∞—É–∑—ã',
  '–∫—Ä—É–≥ –ø–æ—á—ë—Ç–∞ –≤–æ–∫—Ä—É–≥ –¥–∏–≤–∞–Ω–∞', '–≥—Ä–∞–º–æ—Ç–∞ ¬´–ª—É—á—à–∏–π –ø—Ä–æ–∫—Ä–∞—Å—Ç–∏–Ω–∞—Ç–æ—Ä¬ª', '—É—Ç—Ä–µ–Ω–Ω–∏–π –∑–∞—Ä—è–¥ ¬´–Ω—É –ø–æ–µ—Ö–∞–ª–∏¬ª', '–ø–∞—É–∑–∞ –Ω–∞ –º–µ—á—Ç—É',
  '–æ–ø—Ü–∏—è ¬´–Ω–µ —Å–µ–≥–æ–¥–Ω—è¬ª', '–ø–∞–∫–µ—Ç –±–∞–≥–æ–≤ –ø—Ä–µ–º–∏—É–º', '—Å–∫—Ä–µ–ø–∞ –Ω–∞—Ä–æ–¥–Ω–æ–≥–æ –µ–¥–∏–Ω–µ–Ω–∏—è ‚Äî –∫–æ—Ç–∏–∫–∏', '—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –Ω–∞ —Å—á–∞—Å—Ç—å–µ',
  '–±–µ—Å–ø—Ä–æ–≤–æ–¥–Ω–∞—è —Å–æ–≤–µ—Å—Ç—å', '—Ç—Ä–µ–Ω–¥ ¬´–Ω–µ —É—Å–ø–µ–ª –∏ –ª–∞–¥–Ω–æ¬ª', '–ø—ã–ª—å–Ω–∞—è –≥–∞–Ω—Ç–µ–ª—è', '–∫–æ–º–±–æ ¬´—á–∞–π+–ø–ª–µ–¥+—è¬ª',
  '–ª–∞–π–∫ –æ—Ç –≤—Å–µ–ª–µ–Ω–Ω–æ–π', '–≥–æ—Ä—Å—Ç—å —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏', '—Ä–µ–∂–∏–º ¬´–Ω–µ–≤–∏–¥–∏–º–∫–∞¬ª', '—Å–º–∞–π–ª–∏–∫ ¬´¬Ø\\_(„ÉÑ)_/¬Ø¬ª',
  '—á–µ–∫ –Ω–∞ –≤–∑—Ä–æ—Å–ª–æ—Å—Ç—å', '–ø–æ–¥—É—à–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥–ª—è —á—É–≤—Å—Ç–≤', '—à—É—Ç–∫–∞ ¬´—Ç–æ–ª—å–∫–æ –¥–ª—è —Å–≤–æ–∏—Ö¬ª', '–º–µ–º —É—Ä–æ–≤–Ω—è ¬´–±–∞—Ç—è¬ª',
  '–≥–∏–ø—Å –Ω–∞ –Ω–∞–¥–µ–∂–¥–µ', '–Ω–∞–≤–æ—Ä–æ—á–µ–Ω–Ω—ã–π –±—É–¥–∏–ª—å–Ω–∏–∫', '–ø–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Å–ø–æ–∫–æ–π—Å—Ç–≤–∏–µ', '–≥–æ—Ä—è—á–∞—è –∫—Ä—É–∂–∫–∞ –∑–∞–±–æ—Ç—ã',
  '–Ω–∞—Å—Ç—Ä–æ–π–∫–∞ ¬´—Ç–∏—Ö–∏–π –≤–æ—Å—Ç–æ—Ä–≥¬ª', '–∫—Ä–æ—à–∫–∏ –æ—Ç —É—Å–ø–µ—Ö–∞', '–ª–∞–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –º–µ—á—Ç–∞', '–¥–∏—Å–∫–æ–Ω—Ç –Ω–∞ –ø—Ä–æ–≤–∞–ª',
  '–∂–µ–ª–µ–∑–Ω–∞—è –æ—Ç–º–∞–∑–∫–∞', '–∏–Ω—Å—Ç—Ä—É–∫—Ç–∞–∂ –ø–æ —Å—á–∞—Å—Ç—å—é', '–≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –æ–ø—Ç–∏–º–∏–∑–º', '–º–µ—Ç—Ä–∏–∫–∞ ¬´–Ω—É –Ω–µ —Ç–∞–∫ —É–∂ –∏ –ø–ª–æ—Ö–æ¬ª',
  '–ø–æ–¥–∫–∞—Å—Ç ¬´–∏ —Ç–∞–∫ —Å–æ–π–¥—ë—Ç¬ª', '–ø–ª—é—à–µ–≤—ã–π –ø–µ—Ä—Ñ–µ–∫—Ü–∏–æ–Ω–∏–∑–º', '–ø–æ–¥–¥–µ—Ä–∂–∫–∞ –¥—Ä—É–≥–∞ –Ω–∞ –º–∏–Ω–∏–º–∞–ª–∫–∞—Ö', '—Ä–µ–∂–∏–º ¬´–ø–æ—Ç–µ—Ä–ø–ª—é¬ª',
  '–≤–∏—Ç–∞–º–∏–Ω ¬´–ø–æ–ª—É—á–∏—Ç—Å—è¬ª', '—â–µ–ø–æ—Ç–∫–∞ –∑–¥–æ—Ä–æ–≤–æ–≥–æ –ø–æ—Ñ–∏–≥–∏–∑–º–∞', '–≤–µ–∂–ª–∏–≤—ã–π –∑—É–º-–≤—ã—Ö–æ–¥', '–ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è —É—Å—Ç–∞–ª–æ—Å—Ç—å',
  '–º–µ–¥–≤–µ–∂—å–∏ –æ–±—ä—è—Ç–∏—è', '—Å—Ç–∏–∫–µ—Ä ¬´–º–æ–ª–æ–¥—á–∏–Ω–∞¬ª', '—á—É—Ç—å-—á—É—Ç—å –Ω–∞–≥–ª–æ—Å—Ç–∏', '–±—É—Ç—ã–ª–∫–∞ ¬´–≤–¥–æ—Ö-–≤—ã–¥–æ—Ö¬ª',
  '–∑–∞–ø–∞—Å–Ω–æ–π –ø–ª–∞–Ω ¬´–∞–≥–∞¬ª', '–Ω–∞–±–æ—Ä ¬´–Ω–µ –¥—Ä–∞–º–∞—Ç–∏–∑–∏—Ä—É–π¬ª', '—Ñ–ª–µ—à–∫–∞ —Å –º–µ—á—Ç–æ–π', '–ø–ª–µ–¥ –¥–ª—è –¥–≤–æ–∏—Ö',
  '–º–æ–ª—á–∞–ª–∏–≤–æ–µ –ø—Ä–∏–∑–Ω–∞–Ω–∏–µ', '—Å–º–µ—Ö —Å–∫–≤–æ–∑—å —Å—Ä–æ–∫–∏', '—Ä—É–∫–æ–ø–æ–∂–∞—Ç–∏–µ —Å —Å—É–¥—å–±–æ–π', '–∫–æ–º–ø–∞—Å –Ω–∞ –∫—É—Ö–Ω—é',
  '—ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã–π –∫–æ—Ç –í–∞—Å–∏–ª–∏–π', '–≤–µ—á–µ—Ä–Ω–∏–π —Ä–∏—Ç—É–∞–ª ¬´–Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞—Ç—å¬ª', '–∫–æ–Ω—Ñ–µ—Ç–∞ –¥–ª—è —Å–æ–≤–µ—Å—Ç–∏', '–¥–∏—Å–∫–æ –¥–ª—è —Ç–∞–ø–æ—á–µ–∫',
  '–≤—ã–µ–∑–¥–Ω–æ–π —à–∞—à–ª—ã–∫ –∏–¥–µ–π', '–±—ã—Å—Ç—Ä—ã–π –ø–∏—Ä–æ–∂–æ–∫', '—Ç—Ä–µ—Ç–∏–π –≥–ª–∞–∑ –¥–µ–¥–ª–∞–π–Ω–∞', '–æ—Ç—á–∞—è–Ω–Ω–∞—è —Å–º–µ–ª–æ—Å—Ç—å',
  '–ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –ø–æ –∫–Ω–æ–ø–∫–µ', '–ª—É–∫ ¬´—è –≤ –æ—Ç–ø—É—Å–∫–µ –≤–Ω—É—Ç—Ä–∏¬ª', '–±–∞—Ç–∞—Ä–µ–π–∫–∞ –Ω–∞ —É–ª—ã–±–∫—É', '–ø–∞—á–∫–∞ ¬´–Ω—É –∏ —á—Ç–æ¬ª',
  '–ø–µ—Ä–µ–¥—ã—à–∫–∞ —Å –ø–µ—á–µ–Ω—å–∫–æ–π', '–¥–∏–∫–æ–µ –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ', '–∫–æ–Ω—Ç—É—Ä –º–µ—á—Ç—ã', '–ø—Ä–æ—à–∏–≤–∫–∞ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞',
  '–º—è–≥–∫–∞—è —Å–∏–ª–∞ ¬´–ø–æ–∑–≤–æ–Ω—é –∑–∞–≤—Ç—Ä–∞¬ª', '–∫—Ä–æ—Å—Å–æ–≤–∫–∏ –¥–ª—è –¥–∏–≤–∞–Ω–∞', '—Å–æ–ª—å –Ω–∞ –∫–∞—Ä–º—É', '—Å–ø–∏–Ω–Ω–µ—Ä –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏',
  '–º–∞–≥–Ω–∏—Ç–∏–∫ ¬´—Ö–≤–∞—Ç–∏—Ç –Ω—ã—Ç—å¬ª', '—Ä—É—á–Ω–æ–π —ç–Ω—Ç—É–∑–∏–∞–∑–º', '–ø–æ–ø—É—Ç–Ω—ã–π –≤–µ—Ç–µ—Ä –ø–µ—Ä–µ–º–µ–Ω', '—â–∏—Ç –æ—Ç –ª–∏—à–Ω–∏—Ö —Å–æ–≤–µ—Ç–æ–≤',
  '–ø–ª–∞—Ç–∏–Ω–æ–≤–∞—è –æ—Ç–º–∞–∑–∫–∞', '—Å–æ—á–Ω–æ–µ ¬´–ø–æ—Ç–æ–º¬ª', '—à–∞–Ω—Å –Ω–∞ –Ω–æ–≤–æ–µ', '–≥—É–º–∞–Ω–∏—Ç–∞—Ä–Ω–∞—è –ø–æ–º–æ—â—å –º–æ–µ–º—É –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—é',
  '–Ω–∞–≤–æ—Ä–æ—á–µ–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ –¥–µ–ª', '–∫–æ—Ç-–ø—Å–∏—Ö–æ–ª–æ–≥', '—à–∞–ø–∫–∞-–Ω–µ–≤–∏–¥–∏–º–∫–∞ –¥–ª—è —Ç—Ä–µ–≤–æ–≥', '—Ä–µ–∑–µ—Ä–≤–Ω—ã–π –ø–ª–∞–Ω ¬´–º–º–º¬ª',
  '–ø–∞—á–∫–∞ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ ¬´–ª–∞–π—Ç¬ª', '–ª–µ–¥–µ–Ω–µ—Ü —Ç–µ—Ä–ø–µ–Ω–∏—è', '—Ç–µ–ø–ª–æ –∏–∑ –º–∏–∫—Ä–æ–≤–æ–ª–Ω–æ–≤–∫–∏', '–∫–ª—é—á –æ—Ç —Ö–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫–∞ –Ω–∞ —à–µ–µ'
];

const NSFW_BLACK=[
  '–ù–æ–≤–∞—è –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–∞—è —Ü–µ–Ω–Ω–æ—Å—Ç—å ‚Äî ____, –Ω–æ –ª—É—á—à–µ –±–µ–∑ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞.',
  '–ó–∞–ø—Ä–µ—Ç–∏–ª–∏ –æ–±—Å—É–∂–¥–∞—Ç—å ____ –Ω–∞ –æ–±—â–∏—Ö —Å–æ–∑–≤–æ–Ω–∞—Ö.',
  '–í –±–∞—Ä–µ –∑–∞ —É–≥–ª–æ–º –ø–æ–¥–∞—é—Ç ____ ¬´–¥–ª—è —Å–≤–æ–∏—Ö¬ª.',
  '–†–æ–º–∞–Ω—Ç–∏–∫–∞ ‚Äî —ç—Ç–æ ____ –ø—Ä–∏ —Å–≤–µ—Ç–µ –Ω–æ—É—Ç–±—É–∫–∞.',
  '–ß—Ç–æ —Å–∫—Ä—ã–≤–∞–µ—Ç —Å–ª—É–∂–µ–±–Ω–∞—è –∑–∞–ø–∏—Å–∫–∞? ____.'
];
const NSFW_WHITE=[
  '—Ä–æ–º–∞–Ω —Å –¥–µ–¥–ª–∞–π–Ω–æ–º', '—Å–º—É—â–∞—é—â–∏–π —à—ë–ø–æ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π', '—Ç–∞–Ω–µ—Ü –Ω–∞ –∫—É—Ö–Ω–µ –≤ —Ç—Ä–∏ —É—Ç—Ä–∞', '—á—ë—Ä–Ω—ã–π —é–º–æ—Ä —É—Ä–æ–≤–Ω—è ¬´–º–∞–º, –Ω–µ —Å–º–æ—Ç—Ä–∏¬ª', '—Å–ª–∏—à–∫–æ–º —á–µ—Å—Ç–Ω—ã–π —Ç–æ—Å—Ç'
];

function ensureMinimumDeck(base, useNSFW){
  const b=[...(base.black||[]),...BASE_BLACK,...EXTRA_BLACK_DOUBLE];
  const w=[...(base.white||[]),...BASE_WHITE];
  if(useNSFW){ b.push(...NSFW_BLACK); w.push(...NSFW_WHITE); }
  // –≥–µ–Ω–µ—Ä–∞—Ç–∏–≤–Ω—ã–µ —Å–ø–∏—Å–∫–∏ –¥–ª—è –¥–æ–±–∏–≤–∫–∏
  const adj=['–ª–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π','—Å–∫—Ä–æ–º–Ω—ã–π','—Ö—Ä—É–ø–∫–∏–π','—Å—Ç–∞–ª—å–Ω–æ–π','–º—è–≥–∫–∏–π','—É–¥–∏–≤–∏—Ç–µ–ª—å–Ω—ã–π','–∫–æ—Å–º–∏—á–µ—Å–∫–∏–π','—Ç–∞–∫—Ç–∏—á–µ—Å–∫–∏–π','–¥–æ–º–∞—à–Ω–∏–π','—Ç—É—Ä–±–æ','–∞–Ω—Ç–∏—Å—Ç—Ä–µ—Å—Å','–±–æ—Ç–∞–Ω—Å–∫–∏–π','–∫–∞—Ä–º–∞–Ω–Ω—ã–π','–ø—Ä–∞–∑–¥–Ω–∏—á–Ω—ã–π','–≥–µ—Ä–æ–∏—á–µ—Å–∫–∏–π','—Å—Ç—Ä–∞–Ω–Ω—ã–π','–æ—Å–æ–∑–Ω–∞–Ω–Ω—ã–π','—ç–∫–æ–ª–æ–≥–∏—á–Ω—ã–π'];
  const noun=['–∫–∞–∫—Ç—É—Å','–µ–∂–µ–¥–Ω–µ–≤–Ω–∏–∫','–∫–µ–∫—Å','–ø–ª–µ–¥','–∫–æ—Ç –≤ –∫–æ—Ä–æ–±–∫–µ','—Ç–∞–Ω–µ—Ü –ø–æ–±–µ–¥–∏—Ç–µ–ª—è','—É—Ç—Ä–µ–Ω–Ω–∏–π —Ä–∏—Ç—É–∞–ª','–ø–ª–∞–Ω –ë','–∑—É–º-—Å–æ–∑–≤–æ–Ω','–º–∞—Ä–∞—Ñ–æ–Ω —Å–µ—Ä–∏–∞–ª–æ–≤','–¥–∏–≤–∞–Ω–Ω—ã–π —Å—Ç–∞—Ä—Ç–∞–ø','—á–∞–π –±–µ–∑ —Å–∞—Ö–∞—Ä–∞','—Å—Ç–∞–∫–∞–Ω –≤–æ–¥—ã','—ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è –æ—á–µ—Ä–µ–¥—å','–ø–µ—Ä–µ—Ä—ã–≤ –Ω–∞ —Å–µ–±—è','–∫–∞—Ä—Ç–∞ –∂–µ–ª–∞–Ω–∏–π','—á–∏—Å—Ç—ã–π —Å—Ç–æ–ª','—É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ –Ω–∞ —Ä–∞—Å—Ç—è–∂–∫—É'];
  const tails=['–≤ –ø–æ–¥–∞—Ä–æ–∫','–≤ 3 —á–∞—Å–∞ –Ω–æ—á–∏','–ø–æ –ø–æ–¥–ø–∏—Å–∫–µ','–Ω–∞ —Å–∫–æ—Ä—É—é —Ä—É–∫—É','–≤ —Ä–µ–∂–∏–º–µ –∏–Ω–∫–æ–≥–Ω–∏—Ç–æ','–±–µ–∑ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π','—Å –¥–æ—Å—Ç–∞–≤–∫–æ–π –∑–∞–≤—Ç—Ä–∞','–Ω–∞ —É–¥–∞–ª—ë–Ω–∫–µ','—Å –æ–¥–æ–±—Ä–µ–Ω–∏—è –∫–æ—Ç–∞','–≤ —Ö–æ—Ä–æ—à–µ–º —Å–º—ã—Å–ª–µ','–±–µ–∑ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏','–≤ –ø–æ—Å–ª–µ–¥–Ω—é—é —Å–µ–∫—É–Ω–¥—É','–≤ –ø—Ä–µ–¥–µ–ª–∞—Ö —Ä–∞–∑—É–º–Ω–æ–≥–æ','–¥–ª—è –≥–∞–ª–æ—á–∫–∏','–ø–æ –≤—ã—Ö–æ–¥–Ω—ã–º','–¥–ª—è –¥—É—à–∏'];
  const seeds=['–ú–æ–π –¥–µ–Ω—å –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å ____.','–ù–∞ —Å–æ–≤–µ—â–∞–Ω–∏–∏ –ª—É—á—à–µ –Ω–µ –æ–±—Å—É–∂–¥–∞—Ç—å ____.','–°–µ–∫—Ä–µ—Ç —É—Å–ø–µ—à–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ ‚Äî ____.','–°–µ–≥–æ–¥–Ω—è—à–Ω–∏–π –ø–ª–∞–Ω: –∫–æ—Ñ–µ, –¥–µ–ª–∞ –∏ ____.','–°–∞–º—ã–π —Å—Ç—Ä–∞–Ω–Ω—ã–π –ø–æ–¥–∞—Ä–æ–∫ ‚Äî ____.','–ò–¥–µ–∞–ª—å–Ω–æ–µ –∞–ª–∏–±–∏: ____.','–ì–ª–∞–≤–Ω—ã–π –∞–Ω—Ç–∏—Å—Ç—Ä–µ—Å—Å ‚Äî ____.','–í –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–º —á–∞—Ç–µ –∑–∞–±–∞–Ω–∏–ª–∏ —Ç–µ–º—É ____.','–ì–ª–∞–≤–Ω–∞—è —Ñ–∏—á–∞ –Ω–æ–≤–æ–≥–æ –∞–π—Ñ–æ–Ω–∞ ‚Äî ____.','–ï—Å–ª–∏ –±—ã —É –º–µ–Ω—è –±—ã–ª —Å–ª–æ–≥–∞–Ω, –æ–Ω –±—ã –±—ã–ª –ø—Ä–æ ____.','–ù–∞ TED —è –≤—ã—Å—Ç—É–ø–ª—é –ø—Ä–æ ____.','User story –Ω–∞ —Å–µ–≥–æ–¥–Ω—è ‚Äî ____.','–Ø –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ –æ—Ç–∫–∞–∑—ã–≤–∞—é—Å—å –æ—Ç ____.','–°–µ–≥–æ–¥–Ω—è –æ—Ç–º–µ–Ω—è–µ—Ç—Å—è –≤—Å—ë, –∫—Ä–æ–º–µ ____.'];

  while(b.length<MIN_BLACK){ const s=seeds[b.length%seeds.length]; b.push(s); }
  while(w.length<MIN_WHITE){ const i=w.length; w.push(`${adj[i%adj.length]} ${noun[(i*7)%noun.length]} ${tails[(i*13)%tails.length]}`); }
  return {black:shuffle(b), white:shuffle(w)};
}

function drawBlack(){ if(!game.deck.black.length){ game.deck.black=shuffle([...game.deck.discardBlack]); game.deck.discardBlack=[]; } return game.deck.black.pop()||'‚Äî'; }
function drawWhite(){ if(!game.deck.white.length){ game.deck.white=shuffle([...game.deck.discardWhite]); game.deck.discardWhite=[]; } return game.deck.white.pop()||'‚Äî'; }
function topUpHand(hand,t=7){ const arr=[...(hand||[])]; while(arr.length<t) arr.push(drawWhite()); return arr; }

// ====== –ì–ª–æ–±–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
const game={
  state:{status:STATUS.LOBBY,round:0,roundsTotal:ROUNDS_TOTAL,blackCard:'',lastWinnerName:'',lastAnswer:'',currentHostPid:null,currentHostName:'',timerEndsAt:null},
  players:{}, playersOrder:[], submissions:{}, submissionsOrder:[],
  deck:{black:[],white:[],discardBlack:[],discardWhite:[]},
  nsfw:false
};
const local={
  playerId:localStorage.getItem('playerId')||uid(),
  roomId:null,name:'',isCreator:false,hasSubmitted:false,
  selectedIndex:null,selectedText:'',submittedText:'',
  timerInterval:null,autoPickFired:false,activeHand:[]
};
localStorage.setItem('playerId',local.playerId);

// ====== Firebase init
let db=null, firebaseInitError=null, connectivityOk=false, lastConnMsg='';
try{ firebase.initializeApp(FIREBASE_CONFIG); db=firebase.database(); }
catch(e){ firebaseInitError=e; console.error('Firebase init error',e); }

const roomRef = () => db.ref(`rooms/${local.roomId}`);
const stateRef = () => roomRef().child('state');
const playersRef = () => roomRef().child('players');
const orderRef = () => roomRef().child('playersOrder');
const submissionsRef = () => roomRef().child('submissions');
const perPlayerRef = (pid) => roomRef().child(`perPlayer/${pid}`);
const deckRef = () => roomRef().child('deck');
const eventsRef = () => roomRef().child('events');

async function testDbConnection(){
  if(!db){ lastConnMsg='Firebase –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω'; updateConnStatus(false,lastConnMsg); return false; }
  try{
    const ping=db.ref('_ping').push();
    await ping.set({t:now(),ua:navigator.userAgent.slice(0,80)});
    await ping.remove();
    lastConnMsg='OK: –µ—Å—Ç—å –¥–æ—Å—Ç—É–ø –∫ Realtime DB'; updateConnStatus(true,lastConnMsg); return true;
  }catch(e){ lastConnMsg=normalizeError(e); updateConnStatus(false,lastConnMsg); return false; }
}
function updateConnStatus(ok,msg){ const el=$('#connStatus'); el.textContent='–°—Ç–∞—Ç—É—Å: '+(ok?'–ø–æ–¥–∫–ª—é—á–µ–Ω–æ':'–æ—à–∏–±–∫–∞'); el.title=msg||''; el.style.background=ok?'var(--accent-2)':'var(--chip)'; }

function unsubscribeAll(){ if(!local.roomId||!db)return; stateRef().off(); playersRef().off(); orderRef().off(); submissionsRef().off(); perPlayerRef(local.playerId).off(); eventsRef().off(); deckRef().off(); }

function orderedPlayerIds(ps){ return Object.keys(ps||{}).sort((a,b)=>{const pa=ps[a]||{},pb=ps[b]||{},ja=pa.joinedAt||0,jb=pb.joinedAt||0;return ja!==jb?ja-jb:a.localeCompare(b)}); }
function activeOrder(){ const ps=game.players||{}; return (game.playersOrder||[]).filter(id=>ps[id]?.active!==false); }
function activePlayersCount(){ return Object.values(game.players||{}).filter(p=>p&&p.active!==false).length }
function nextHostId(order,current){ if(!Array.isArray(order)||!order.length)return null; if(!current)return order[0]; const i=order.indexOf(current); return i===-1?order[0]:order[(i+1)%order.length]; }
function expectedSubmissions(){ return Math.max(0,activeOrder().length-1); }

function subscribeRoom(){ if(!db||!local.roomId)return; unsubscribeAll();
  stateRef().on('value',s=>{const v=s.val(); if(!v)return; game.state=v; renderState(); startTimerTick();});
  playersRef().on('value',s=>{const v=s.val()||{}; game.players=v; renderPlayers(); if(local.isCreator)syncPlayersOrder(); ensureHostValidity(); updateProgressChip(); if(AUTO_START)maybeAutoStart();});
  orderRef().on('value',s=>{const v=s.val(); if(Array.isArray(v)){ game.playersOrder=v; ensureHostValidity(); updateProgressChip(); if(AUTO_START)maybeAutoStart(); }});
  submissionsRef().on('value',s=>{ renderSubmissions(s.val()||{}); });
  perPlayerRef(local.playerId).on('value',s=>{ const d=s.val()||{hand:[],submitted:false,lastText:''}; local.activeHand=d.hand||[]; local.hasSubmitted=!!d.submitted; local.submittedText=d.lastText||''; renderHand(local.activeHand); updateHandState(); updateActionBar(); });
  if(local.isCreator){ deckRef().on('value',s=>{ const d=s.val(); if(d){ game.deck.black=d.black||[]; game.deck.white=d.white||[]; game.deck.discardBlack=d.discardBlack||[]; game.deck.discardWhite=d.discardWhite||[]; } }); eventsRef().on('child_added',handleHostEvent); }
}

// ====== Create / Join
function showScreen(id){ ['screenCreate','screenNameOnly','screenGame'].forEach(s=>$('#'+s).classList.remove('active')); $('#'+id).classList.add('active'); }
function enterGameUI(){ showScreen('screenGame'); if(local.isCreator){ $('#shareRow').style.display='flex'; updateShareLink(); } else $('#shareRow').style.display='none'; }
function updateShareLink(){ const url=new URL(location.href); url.searchParams.set('room',local.roomId); $('#shareLink').value=url.toString(); history.replaceState(null,'',url); }
function validateName(v){ const t=(v||'').trim(); if(t.length<2)throw new Error('–ò–º—è —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–æ–µ.'); if(/^[0-9]+$/.test(t))throw new Error('–ò–º—è –Ω–µ –º–æ–∂–µ—Ç —Å–æ—Å—Ç–æ—è—Ç—å —Ç–æ–ª—å–∫–æ –∏–∑ —Ü–∏—Ñ—Ä.'); return t.slice(0,24); }

function loadDeckLocal(){
  let raw=localStorage.getItem(STORAGE_KEY), base=raw?(()=>{try{return JSON.parse(raw)}catch{return {black:[],white:[]}}})():{black:[],white:[]};
  const useNSFW=$('#nsfwToggle')?.checked || false; game.nsfw=useNSFW;
  const filled=ensureMinimumDeck(base,useNSFW);
  game.deck.black=filled.black; game.deck.white=filled.white; game.deck.discardBlack=[]; game.deck.discardWhite=[];
  localStorage.setItem(STORAGE_KEY,JSON.stringify({black:filled.black,white:filled.white}));
}

async function registerPlayer(name){
  const safe=name||localStorage.getItem('playerName')||`–ò–≥—Ä–æ–∫ ${local.playerId.slice(-4)}`;
  local.name=safe; localStorage.setItem('playerName',safe);
  const ref=playersRef().child(local.playerId);
  await ref.set({name:safe,score:0,joinedAt:now(),active:true,isCreator:local.isCreator});
  await ref.onDisconnect().update({active:false,leftAt:now()});
  await perPlayerRef(local.playerId).set({hand:[],submitted:false,lastText:''});
  await perPlayerRef(local.playerId).onDisconnect().remove();
  if(!local.isCreator){
    await orderRef().transaction(order=>{ const base=Array.isArray(order)?order.slice():[]; if(!base.includes(local.playerId)) base.push(local.playerId); return base; });
    await eventsRef().push({type:'needHand',playerId:local.playerId,t:now()});
  } else {
    await orderRef().set([local.playerId]);
  }
}

async function createRoom(){
  if(!db){ showError(firebaseInitError||'Firebase –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω'); return }
  if(!(connectivityOk||await testDbConnection())) return;
  try{
    const playerName=validateName($('#createName').value);
    const roomId=($('#createRoomId').value||'').trim().toUpperCase();
    if(roomId.length<4) throw new Error('ID –∫–æ–º–Ω–∞—Ç—ã –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 4 —Å–∏–º–≤–æ–ª–∞.');
    local.roomId=roomId; local.isCreator=true;
    loadDeckLocal();
    await roomRef().set({creatorId:local.playerId,createdAt:now(),nsfw:game.nsfw});
    await stateRef().set({status:STATUS.LOBBY,round:0,roundsTotal:ROUNDS_TOTAL,blackCard:'',lastWinnerName:'',lastAnswer:'',currentHostPid:local.playerId,currentHostName:playerName,timerEndsAt:null});
    await deckRef().set({black:game.deck.black,white:game.deck.white,discardBlack:[],discardWhite:[]});
    await registerPlayer(playerName);
    subscribeRoom(); enterGameUI(); toast('–ö–æ–º–Ω–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∞');
  }catch(e){ $('#createError').textContent=normalizeError(e); showError(e); }
}

async function joinRoomWithNameOnly(){
  if(!db){ showError(firebaseInitError||'Firebase –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω'); return }
  if(!(connectivityOk||await testDbConnection())) return;
  try{
    const playerName=validateName($('#nameOnly').value);
    await registerPlayer(playerName);
    subscribeRoom(); enterGameUI(); toast('–ü–æ–¥–∫–ª—é—á–µ–Ω–æ –∫ –∫–æ–º–Ω–∞—Ç–µ');
  }catch(e){ $('#nameOnlyError').textContent=normalizeError(e); showError(e); }
}

// ====== –°–æ–±—ã—Ç–∏—è –≤–µ–¥—É—â–µ–≥–æ –∏ —Ñ–ª–æ—É
async function handleHostEvent(snap){ const ev=snap.val(),key=snap.key; if(!ev)return; try{
  if(ev.type==='needHand') await hostGiveHand(ev.playerId);
  if(ev.type==='pickWinner') await hostPickWinner(ev.submissionId);
  if(ev.type==='autoPick') await hostAutoPick(ev.submissionId||null);
  if(ev.type==='nextRound') await advanceRound();
} catch(e){ showError(e) } finally { eventsRef().child(key).remove(); } }

async function hostGiveHand(pid){
  if(!pid)return; const player=(await playersRef().child(pid).get()).val(); if(!player||player.active===false)return;
  const currentHost=game.state.currentHostPid; const snap=await perPlayerRef(pid).get(); const data=snap.val()||{hand:[],submitted:false,lastText:''};
  const shouldHave=pid!==currentHost && player.active!==false; const hand=shouldHave?topUpHand(data.hand||[]):[];
  await perPlayerRef(pid).set({hand,submitted:false,lastText:''});
}

async function hostPickWinner(id){
  if(!id)return; const s=(await stateRef().get()).val(); if(!s||s.status!==STATUS.COLLECT)return;
  const subs=(await submissionsRef().get()).val()||{}; const e=subs[id]; if(!e)return;
  await playersRef().child(e.playerId).transaction(d=>{ if(!d)return d; return {...d,score:(d.score||0)+1} });
  await collectWhiteToDiscard(subs);
  const name=game.players[e.playerId]?.name||'‚Äî';
  await stateRef().update({status:STATUS.RESULT,lastWinnerName:name,lastAnswer:e.text,timerEndsAt:null});
}

function randomSubmissionKey(subs){ const keys=Object.keys(subs||{}); if(!keys.length)return null; const r=Math.random(); return keys[Math.floor(r*keys.length)]; }
async function hostAutoPick(id){ const s=(await stateRef().get()).val(); if(!s||s.status!==STATUS.COLLECT)return; const subs=(await submissionsRef().get()).val()||{}; const pick=id||randomSubmissionKey(subs);
  if(pick&&subs[pick]){ await hostPickWinner(pick) } else { await collectWhiteToDiscard(subs); await stateRef().update({status:STATUS.RESULT,lastWinnerName:'',lastAnswer:'',timerEndsAt:null}) }
  updateActionBar();
}
async function collectWhiteToDiscard(subs){ Object.values(subs||{}).forEach(x=>{ if(x&&x.text) game.deck.discardWhite.push(x.text) }); await deckRef().set({black:game.deck.black,white:game.deck.white,discardBlack:game.deck.discardBlack,discardWhite:game.deck.discardWhite}); }

async function advanceRound(){
  if(!local.isCreator)return;
  const s=(await stateRef().get()).val()||{}, players=(await playersRef().get()).val()||{}; const order=activeOrder();
  if(order.length<MIN_PLAYERS){ await stateRef().update({status:STATUS.LOBBY,timerEndsAt:null}); toast('–ù—É–∂–Ω–æ –º–∏–Ω–∏–º—É–º 2 –∏–≥—Ä–æ–∫–∞'); return }
  const baseCurrent=s.status===STATUS.LOBBY?null:s.currentHostPid; const hostId=nextHostId(order,baseCurrent); const hostName=players[hostId]?.name||'‚Äî';
  if(s.blackCard) game.deck.discardBlack.push(s.blackCard);
  await submissionsRef().remove();
  await Promise.all(order.map(async pid=>{ const snap=await perPlayerRef(pid).get(); const data=snap.val()||{hand:[],submitted:false,lastText:''}; const shouldHave=pid!==hostId; const hand=shouldHave?topUpHand(data.hand||[]):[]; await perPlayerRef(pid).set({hand,submitted:false,lastText:''}); }));
  const black=drawBlack(); const round=s.status===STATUS.LOBBY?1:(s.round||0)+1; const timerEndsAt=now()+ROUND_TIMER_SECONDS*1000;
  await stateRef().set({status:STATUS.COLLECT,round,roundsTotal:ROUNDS_TOTAL,blackCard:black,lastWinnerName:'',lastAnswer:'',currentHostPid:hostId,currentHostName:hostName,timerEndsAt});
  await deckRef().set({black:game.deck.black,white:game.deck.white,discardBlack:game.deck.discardBlack,discardWhite:game.deck.discardWhite});
  game.submissionsOrder=[];
}

// ====== –†–µ–Ω–¥–µ—Ä–∏–Ω–≥
function fillBlack(b,w){ const safe=escapeHtml(w||'‚Äî'); const has=(b||'').includes('____'); if(has){ return escapeHtml(b||'‚Äî').replace(/____/g, '<b>'+safe+'</b>'); } return `${escapeHtml(b||'‚Äî')} ‚Äî <b>${safe}</b>`; }
function buildHandHint(st){ if(game.state.currentHostPid===local.playerId) return st===STATUS.COLLECT?'–í—ã –≤–µ–¥—É—â–∏–π ‚Äî –æ–∂–∏–¥–∞–π—Ç–µ –æ—Ç–≤–µ—Ç—ã –∏ –≤—ã–±–µ—Ä–∏—Ç–µ –ø–æ–±–µ–¥–∏—Ç–µ–ª—è.':'–í—ã —É–ø—Ä–∞–≤–ª—è–µ—Ç–µ —Ö–æ–¥–æ–º –∏–≥—Ä—ã.'; if(st===STATUS.LOBBY) return '–û–∂–∏–¥–∞–µ–º —Å—Ç–∞—Ä—Ç —Ä–∞—É–Ω–¥–∞.'; if(st===STATUS.RESULT) return '–†–∞—É–Ω–¥ –∑–∞–≤–µ—Ä—à—ë–Ω, –∂–¥—ë–º –Ω–æ–≤—É—é —á—ë—Ä–Ω—É—é –∫–∞—Ä—Ç—É.'; if(local.hasSubmitted) return '–û—Ç–≤–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω, –∂–¥—ë–º –æ—Å—Ç–∞–ª—å–Ω—ã—Ö.'; if(local.selectedIndex==null) return '–í—ã–±–µ—Ä–∏—Ç–µ –æ–¥–Ω—É –∫–∞—Ä—Ç—É –∏ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ.'; return '–ù–∞–∂–º–∏—Ç–µ ¬´–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å¬ª, —á—Ç–æ–±—ã –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—É—é –∫–∞—Ä—Ç—É.'; }

function renderState(){
  const st=game.state.status||STATUS.LOBBY;
  $('#blackText').innerHTML=escapeHtml(game.state.blackCard||'‚Äî');
  $('#roleChip').hidden=st===STATUS.LOBBY; $('#roleChip').textContent=game.state.currentHostPid===local.playerId?'–í—ã –≤–µ–¥—É—â–∏–π':'–í—ã –∏–≥—Ä–æ–∫';
  $('#timerChip').hidden=st!==STATUS.COLLECT; $('#progressChip').hidden=st!==STATUS.COLLECT;
  $('#resultBlock').style.display=st===STATUS.RESULT?'block':'none';
  $('#winnerLine').innerHTML=game.state.lastWinnerName?`${escapeHtml(game.state.lastWinnerName)} –ø–æ–ª—É—á–∞–µ—Ç –æ—á–∫–æ –∑–∞ ${fillBlack(game.state.blackCard||'',game.state.lastAnswer||'')}`:'–í —ç—Ç–æ–º —Ä–∞—É–Ω–¥–µ –Ω–µ –±—ã–ª–æ –ø–æ–±–µ–¥–∏—Ç–µ–ª—è.';
  $('#resultHint').textContent=game.state.currentHostPid===local.playerId?'–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞—É–Ω–¥.':'–ñ–¥—ë–º —Ç–µ–∫—É—â–µ–≥–æ –≤–µ–¥—É—â–µ–≥–æ.';
  $('#hostSummary').textContent=st===STATUS.LOBBY?'–û–∂–∏–¥–∞–µ–º –∏–≥—Ä–æ–∫–æ–≤.':st===STATUS.COLLECT?`–í–µ–¥—É—â–∏–π: ${escapeHtml(game.state.currentHostName||'‚Äî')}`:'–†–∞—É–Ω–¥ –∑–∞–≤–µ—Ä—à—ë–Ω.';
  $('#handHint').textContent=buildHandHint(st);
  const count=activePlayersCount(); const canStart=local.isCreator && st===STATUS.LOBBY;
  const lobby=$('#lobbyActions'), hint=$('#lobbyHint');
  if(lobby){ lobby.style.display=canStart?'flex':'none'; hint.textContent = count<MIN_PLAYERS ? `–ù—É–∂–Ω–æ –º–∏–Ω–∏–º—É–º ${MIN_PLAYERS} –∏–≥—Ä–æ–∫–∞(–æ–≤). –°–µ–π—á–∞—Å: ${count}.` : `–ì–æ—Ç–æ–≤—ã –Ω–∞—á–∞—Ç—å. –ò–≥—Ä–æ–∫–æ–≤: ${count}.`; $('#btnStartGame').disabled = !(count>=MIN_PLAYERS); }
  updateProgressChip();
}

function renderPlayers(){
  const list=$('#playersList'); list.innerHTML=''; const players=game.players||{}, ordered=orderedPlayerIds(players);
  ordered.forEach(id=>{ const d=players[id]; const row=document.createElement('div'); row.style.cssText='display:flex;align-items:center;justify-content:space-between;padding:8px 0'; const tags=[]; if(d.isCreator)tags.push('–º–æ–¥–µ—Ä–∞—Ç–æ—Ä'); if(id===game.state.currentHostPid)tags.push('–≤–µ–¥—É—â–∏–π'); if(d.active===false)tags.push('offline'); row.innerHTML=`<div>${escapeHtml(d.name||'–ë–µ–∑—ã–º—è–Ω–Ω—ã–π')}${tags.length?` <span class="small muted">(${tags.join(', ')})</span>`:''}</div><div class="chip">${d.score||0}</div>`; list.appendChild(row) }); if(!ordered.length) list.innerHTML='<div class="muted small">–ü–æ–∫–∞ –Ω–∏–∫–æ–≥–æ –Ω–µ—Ç.</div>';
}

function renderHand(hand){
  const c=$('#handCards'); c.innerHTML=''; const disabled=game.state.currentHostPid===local.playerId||game.state.status!==STATUS.COLLECT;
  hand.forEach((text,idx)=>{ const b=document.createElement('button'); b.type='button'; b.className='answer-card'+(disabled?' disabled':' selectable'); b.dataset.index=idx; b.innerHTML=`<div style="font-size:18px;line-height:1.5;">${escapeHtml(text)}</div>`; if(!disabled){ b.onclick=()=>selectCard(idx,text,b); if(idx===local.selectedIndex)b.classList.add('selected') } c.appendChild(b) });
  if(disabled){ local.selectedIndex=null; local.selectedText='' } else if(local.selectedIndex!=null&&local.selectedIndex>=hand.length){ local.selectedIndex=null; local.selectedText='' }
  updateActionBar();
}

function renderSubmissions(map){
  game.submissions=map||{}; const entries=Object.entries(game.submissions), received=entries.length, expected=expectedSubmissions();
  const timerExpired=game.state.timerEndsAt && now()>=game.state.timerEndsAt;
  const reveal=game.state.status===STATUS.RESULT || (game.state.status===STATUS.COLLECT && (timerExpired || (expected>0 && received>=expected)));
  const list=$('#submissionsList'); list.innerHTML=''; const hint=$('#submissionsHint');
  if(!entries.length){ hint.textContent=game.state.status===STATUS.COLLECT?'–ö–∞—Ä—Ç—ã –ø–æ—è–≤—è—Ç—Å—è –ø–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ –∏–≥—Ä–æ–∫–∞–º–∏.':'–ù–∞ —Å—Ç–æ–ª–µ –Ω–µ—Ç –æ—Ç–≤–µ—Ç–æ–≤.'; return }
  if(!reveal){ hint.textContent='–û—Ç–≤–µ—Ç—ã —Å–∫—Ä—ã—Ç—ã –¥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Å–±–æ—Ä–∞.'; return }
  hint.textContent=game.state.status===STATUS.COLLECT?'–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–±–µ–¥–∏—Ç–µ–ª—è.':'–í–µ–¥—É—â–∏–π –æ–±—ä—è–≤–∏–ª —Ä–µ–∑—É–ª—å—Ç–∞—Ç.';
  const prev=Array.isArray(game.submissionsOrder)?game.submissionsOrder.filter(id=>game.submissions[id]):[]; if(prev.length!==entries.length){ game.submissionsOrder=shuffle(entries.map(([id])=>id)) }
  game.submissionsOrder.forEach(id=>{ const it=game.submissions[id]; if(!it)return; const b=document.createElement('button'); b.type='button'; b.className='answer-card'; b.innerHTML=`<div class="muted small">–û—Ç–≤–µ—Ç</div><div style="margin-top:8px;font-size:18px;line-height:1.5;">${fillBlack(game.state.blackCard||'',it.text)}</div>`; if(game.state.status===STATUS.COLLECT&&game.state.currentHostPid===local.playerId){ b.classList.add('selectable'); b.onclick=()=>eventsRef().push({type:'pickWinner',submissionId:id,t:now()}) } else b.disabled=true; list.appendChild(b) });
  updateProgressChip();
}

// ====== UI –¥–µ–π—Å—Ç–≤–∏—è
function selectCard(idx,text,btn){ if(game.state.status!==STATUS.COLLECT||local.hasSubmitted)return; local.selectedIndex=idx; local.selectedText=text; $$('#handCards .answer-card').forEach(el=>el.classList.remove('selected')); btn?.classList.add('selected'); updateHandState(); updateActionBar(); }
function updateHandState(){ const b=$('#submittedCard'); b.style.display=local.hasSubmitted&&local.submittedText?'block':'none'; if(local.hasSubmitted&&local.submittedText) $('#submittedText').textContent=local.submittedText; }
function updateProgressChip(){ const chip=$('#progressChip'); if(game.state.status!==STATUS.COLLECT){ chip.hidden=true; return } const expected=expectedSubmissions(),received=Object.keys(game.submissions||{}).length; chip.textContent=`${received}/${expected} –æ—Ç–ø—Ä–∞–≤–∏–ª–∏`; chip.hidden=false }
function updateActionBar(){ const bar=$('#actionBar'),isHost=game.state.currentHostPid===local.playerId,collecting=game.state.status===STATUS.COLLECT; if(!collecting||isHost){ bar.classList.add('hidden'); return } bar.classList.remove('hidden'); if(local.hasSubmitted){ $('#actionHint').textContent='–ö–∞—Ä—Ç–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞. –ñ–¥—ë–º –æ—Å—Ç–∞–ª—å–Ω—ã—Ö.'; $('#btnConfirm').disabled=true } else if(local.selectedIndex==null){ $('#actionHint').textContent='–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ä—Ç—É –∏–∑ —Ä—É–∫–∏, —á—Ç–æ–±—ã –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å.'; $('#btnConfirm').disabled=true } else { $('#actionHint').textContent='–ì–æ—Ç–æ–≤–æ! –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –æ—Ç–ø—Ä–∞–≤–∫—É –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–∞—Ä—Ç—ã.'; $('#btnConfirm').disabled=false } }
function startTimerTick(){ clearInterval(local.timerInterval); if(game.state.status!==STATUS.COLLECT||!game.state.timerEndsAt){ $('#timerChip').hidden=true; return } $('#timerChip').hidden=false; const up=()=>{ const s=Math.max(0,Math.ceil((game.state.timerEndsAt-now())/1000)); $('#timerChip').textContent=`‚è± ${s}s`; if(s<=0){ clearInterval(local.timerInterval); if(!local.autoPickFired){ local.autoPickFired=true; eventsRef().push({type:'autoPick',submissionId:null,t:now()}) } } }; up(); local.timerInterval=setInterval(up,1000); local.autoPickFired=false }
async function submitCard(){ if(game.state.status!==STATUS.COLLECT)return showError('–°–µ–π—á–∞—Å –Ω–µ–ª—å–∑—è –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∫–∞—Ä—Ç—É.'); if(game.state.currentHostPid===local.playerId)return showError('–í–µ–¥—É—â–∏–π –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∫–∞—Ä—Ç—ã.'); if(local.hasSubmitted)return showError('–ö–∞—Ä—Ç–∞ —É–∂–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞.'); if(local.selectedIndex==null)return showError('–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ä—Ç—É.'); const hand=[...local.activeHand],text=hand[local.selectedIndex]; if(!text)return showError('–ö–∞—Ä—Ç–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞.'); hand.splice(local.selectedIndex,1); await perPlayerRef(local.playerId).set({hand,submitted:true,lastText:text}); const id=uid(); await submissionsRef().child(id).set({playerId:local.playerId,text,createdAt:now()}); local.hasSubmitted=true; local.selectedIndex=null; local.selectedText=''; local.submittedText=text; updateHandState(); updateActionBar(); toast('–û—Ç–≤–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω') }
async function nextRound(){ if(game.state.currentHostPid!==local.playerId)return showError('–°–ª–µ–¥—É—é—â–∏–π —Ä–∞—É–Ω–¥ –∑–∞–ø—É—Å–∫–∞–µ—Ç –≤–µ–¥—É—â–∏–π.'); await eventsRef().push({type:'nextRound',t:now()}) }
async function startGame(){ if(!local.isCreator)return showError('–°—Ç–∞—Ä—Ç—É–µ—Ç –≤–µ–¥—É—â–∏–π.'); await advanceRound() }
function copyToClipboard(text){ if(!text) return; if(navigator.clipboard){ navigator.clipboard.writeText(text).then(()=>toast('–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞')).catch(showError) } else { const el=document.createElement('textarea'); el.value=text; document.body.appendChild(el); el.select(); try{ document.execCommand('copy'); toast('–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞') }catch(e){ showError(e) } finally { document.body.removeChild(el) } } }

function syncUI(){ $('#btnCreateRoom').onclick=async()=>{ const btn=$('#btnCreateRoom'); btn.disabled=true; try{ await createRoom(); } finally { btn.disabled=false } };
  $('#btnStartGame').onclick=startGame; $('#btnNextRound').onclick=nextRound; $('#btnConfirm').onclick=submitCard; $('#btnCopyLink').onclick=()=>copyToClipboard($('#shareLink').value||''); $('#btnNameOnly').onclick=joinRoomWithNameOnly; $('#nameOnly').addEventListener('keydown',e=>{ if(e.key==='Enter'){ e.preventDefault(); $('#btnNameOnly').click() } }) }

function setupUI(){ const params=new URLSearchParams(location.search), room=params.get('room'), savedName=localStorage.getItem('playerName')||''; if(room){ local.roomId=room.toUpperCase(); local.isCreator=false; showScreen('screenNameOnly'); $('#nameOnly').value=savedName; stateRef().get().then(snap=>{ const st=snap.val()||{}; $('#inviterName').textContent = st.currentHostName ? st.currentHostName : '–≤–µ–¥—É—â–∏–π'; }).catch(()=>{ $('#inviterName').textContent='–≤–µ–¥—É—â–∏–π' }); setTimeout(()=>{$focus($('#nameOnly'))},0); } else { $('#createRoomId').value=(Math.random().toString(36).slice(2,8)).toUpperCase(); if(savedName) $('#createName').value=savedName; showScreen('screenCreate'); setTimeout(()=>{$focus($('#createName'))},0); } }

function syncPlayersOrder(){ const players=game.players||{}; const activeIds=orderedPlayerIds(players).filter(id=>players[id].active!==false); const cur=Array.isArray(game.playersOrder)?game.playersOrder:[]; const merged=[...new Set([...cur.filter(id=>activeIds.includes(id)),...activeIds])]; if(JSON.stringify(merged)!==JSON.stringify(cur)) orderRef().set(merged) }
function ensureHostValidity(){ const order=activeOrder(),cur=game.state.currentHostPid; if(!order.length)return; if(!cur||!order.includes(cur)){ const next=order[0],name=game.players[next]?.name||'‚Äî'; if(local.isCreator) stateRef().update({currentHostPid:next,currentHostName:name}) } }
function maybeAutoStart(){ if(!local.isCreator)return; if(game.state.status!==STATUS.LOBBY)return; if(activePlayersCount()>=MIN_PLAYERS) advanceRound() }

function renderOnStateChange(){ renderState(); renderHand(local.activeHand); updateActionBar() }

// ====== –∞–≤—Ç–æ—Ç–µ—Å—Ç—ã –±–∞–∑–æ–≤–æ–π –ª–æ–≥–∏–∫–∏ (–≤ –∫–æ–Ω—Å–æ–ª–∏)
(function selfTests(){ try{
  console.log('[tests] shuffle size', shuffle([1,2,3]).length===3);
  console.log('[tests] nextHostId', nextHostId(['a','b','c'],'b')==='c');
  console.log('[tests] expectedSubmissions (3 active -> 2)', (function(){ game.players={'a':{active:true},'b':{active:true},'c':{active:true}}; game.playersOrder=['a','b','c']; return expectedSubmissions()===2; })());
  const tmp={black:['B1'],white:['W1','W2'],discardBlack:[],discardWhite:[]}; game.deck=JSON.parse(JSON.stringify(tmp)); console.log('[tests] drawWhite', drawWhite()==='W2' && game.deck.white.length===1);
  console.log('[tests] topUpHand(5->7)', topUpHand(['x','y','z','k','m'],7).length===7);
} catch(e){ console.warn('self tests failed', e); } })();

// ====== boot
 document.addEventListener('DOMContentLoaded',async()=>{
  syncUI(); setupUI(); setTimeout(async()=>{ connectivityOk=await testDbConnection() },400); renderOnStateChange();
});
</script>
</body>
</html>
